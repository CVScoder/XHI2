10:26:02.260 > [ESP32] === END HMAC DEBUG ===
10:26:02.263 > 6_Final_Packet (60): 810217001700040800000001E973F068 BBF4EBDD2F959B09DB017221DD77543E ...
10:26:02.271 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:02.274 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:02.280 > Sending pipeline data to server (557 bytes)
10:26:02.476 > [HTTP] Response code: 400
10:26:02.476 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:02.482 > [HTTP] Request failed with code: 400
10:26:02.485 > [RETRY] Send failed, waiting 100 ms before retry
10:26:02.580 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:02.580 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:02.586 > Sending pipeline data to server (557 bytes)
10:26:02.966 > [HTTP] Response code: 400
10:26:02.966 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:02.972 > [HTTP] Request failed with code: 400
10:26:02.974 > [RETRY] Send failed, waiting 200 ms before retry
10:26:03.169 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:03.169 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:03.175 > Sending pipeline data to server (557 bytes)
10:26:03.466 > [HTTP] Response code: 400
10:26:03.466 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:03.472 > [HTTP] Request failed with code: 400
10:26:03.474 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:03.480 > [RETRY] Consecutive failures: 1
10:26:03.483 > Health data send failed (retry count: 2/3)
10:26:03.580 > [WebSocket] Disconnected!
10:26:03.581 > [107.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED   
10:26:03.589 > Generated health data: HR-61 SPO2-95 STEPS-541
10:26:03.594 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:03.600 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:03.603 > Generated health data: HR-61 SPO2-95 STEPS-579
10:26:03.608 > [ESP32] MsgKeys: lfsrSeed=0xE557C6E5 tnk[0..3]=F14975C9 trn[0..3]=EF14BD7D
10:26:03.614 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3537394D50
10:26:03.619 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3537394D5000000000000000 
10:26:03.628 > [ESP32][LFSR] Initializing - Seed: 0xE557C6E5 SeedBe: 0xE5C657E5 ChaosKey[0..3]: F14975C9 InitialTap: 0x0029 State: 0xE557C6E5
10:26:03.639 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
10:26:03.647 > 3_After_LFSR (32): AD947AD3763B1986C4CD4516FFEA76A3 669F195A2B7E48F449B30A465FEAB353 
10:26:03.656 > [ESP32][LFSR] Keystream (first 16 bytes): E5C657E5471B4AD68BFF682FCACA25F7
10:26:03.661 > [ESP32][TINKERBELL] Input (first 16 bytes): AD947AD3763B1986C4CD4516FFEA76A3 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:03.672 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F14975C9
10:26:03.680 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): DE41166848E66972519937CD84CBABA2
10:26:03.689 > 4_After_Tinkerbell (32): 73D56CBB3EDD70F4955472DB7B21DD01 779B025468652EA8C3F0EB770904E920
10:26:03.697 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): DE41166848E66972519937CD84CBABA2
10:26:03.705 > 5_After_Transposition (32): E973F068BBF4EBDD2E959B09DB017221 DD77543E54A86C6570C3D57B77200204      
10:26:03.714 > [ESP32] === HMAC DEBUG INFO ===
10:26:03.716 > [ESP32] HMAC Key being used: 5B84341DC88A435FC6B7B9444CD72D664D5B0B87202188E1176A8FB52A579E70
10:26:03.725 > [ESP32] HMAC Input length: 44 bytes
10:26:03.727 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E973F068BBF4EBDD2E959B09DB017221DD77543E
10:26:03.736 > [ESP32] Nonce: 0x00000001
10:26:03.739 > [ESP32] Packet size before HMAC: 60
10:26:03.742 > [ESP32] Computed HMAC Tag: 32CA61BC3873619A46D1A4542574EE49
10:26:03.747 > [ESP32] === END HMAC DEBUG ===
10:26:03.750 > 6_Final_Packet (60): 810217001700040800000001E973F068 BBF4EBDD2E959B09DB017221DD77543E ...
10:26:03.758 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:03.761 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:03.766 > Sending pipeline data to server (557 bytes)
10:26:03.970 > [HTTP] Response code: 400
10:26:03.970 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:03.975 > [HTTP] Request failed with code: 400
10:26:03.978 > [RETRY] Send failed, waiting 100 ms before retry
10:26:04.074 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:04.075 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:04.080 > Sending pipeline data to server (557 bytes)
10:26:04.274 > [HTTP] Response code: 400
10:26:04.274 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:04.280 > [HTTP] Request failed with code: 400
10:26:04.283 > [RETRY] Send failed, waiting 200 ms before retry
10:26:04.478 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:04.479 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:04.484 > Sending pipeline data to server (557 bytes)
10:26:04.722 > [HTTP] Response code: 400
10:26:04.722 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:04.727 > [HTTP] Request failed with code: 400
10:26:04.730 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:04.735 > [RETRY] Consecutive failures: 2
10:26:04.738 > Health data send failed (retry count: 3/3)
10:26:04.741 > Health data transmission failed after max retries
10:26:04.846 > [108.8] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:04.852 > ERROR state - attempting recovery
10:26:04.855 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:04.861 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:04.867 > Generated health data: HR-63 SPO2-95 STEPS-583
10:26:04.869 > [ESP32] MsgKeys: lfsrSeed=0xE557C6E5 tnk[0..3]=F14975C9 trn[0..3]=EF14BD7D
10:26:04.878 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3538334D50
10:26:04.883 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3538334D5000000000000000 
10:26:04.892 > [ESP32][LFSR] Initializing - Seed: 0xE557C6E5 SeedBe: 0xE5C657E5 ChaosKey[0..3]: F14975C9 InitialTap: 0x0029 State: 0xE557C6E5
10:26:04.903 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes       
10:26:04.911 > 3_After_LFSR (32): AD947AD3743B1986C4CD4516FFEA76A3 669F195A2B7142F449B30A465FEAB353
10:26:04.916 > [ESP32][LFSR] Keystream (first 16 bytes): E5C657E5471B4AD68BFF682FCACA25F7
10:26:04.925 > [ESP32][TINKERBELL] Input (first 16 bytes): AD947AD3743B1986C4CD4516FFEA76A3 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:04.933 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F14975C9
10:26:04.944 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): DE41166848E66972519937CD84CBABA2
10:26:04.953 > 4_After_Tinkerbell (32): 73D56CBB3CDD70F4955472DB7B21DD01 779B0254686A24A8C3F0EB770904E920
10:26:04.960 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): DE41166848E66972519937CD84CBABA2
10:26:04.969 > 5_After_Transposition (32): E973F068BBF4EBDD24959B09DB017221 DD77543C54A86C6A70C3D57B77200204      
10:26:04.978 > [ESP32] === HMAC DEBUG INFO ===
10:26:04.981 > [ESP32] HMAC Key being used: 5B84341DC88A435FC6B7B9444CD72D664D5B0B87202188E1176A8FB52A579E70
10:26:04.986 > [ESP32] HMAC Input length: 44 bytes
10:26:04.992 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E973F068BBF4EBDD24959B09DB017221DD77543C
10:26:05.000 > [ESP32] Nonce: 0x00000001
10:26:05.003 > [ESP32] Packet size before HMAC: 60
10:26:05.005 > [ESP32] Computed HMAC Tag: A9A8D69E01561A768D92CC3009EE78D8
10:26:05.011 > [ESP32] === END HMAC DEBUG ===
10:26:05.014 > 6_Final_Packet (60): 810217001700040800000001E973F068 BBF4EBDD24959B09DB017221DD77543C ...
10:26:05.022 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:05.022 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:05.028 > Sending pipeline data to server (557 bytes)
10:26:05.327 > [HTTP] Response code: 400
10:26:05.328 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:05.333 > [HTTP] Request failed with code: 400
10:26:05.335 > [RETRY] Send failed, waiting 100 ms before retry
10:26:05.432 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:05.432 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:05.438 > Sending pipeline data to server (557 bytes)
10:26:05.728 > [HTTP] Response code: 400
10:26:05.728 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:05.733 > [HTTP] Request failed with code: 400
10:26:05.736 > [RETRY] Send failed, waiting 200 ms before retry
10:26:05.933 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:05.933 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:05.938 > Sending pipeline data to server (557 bytes)
10:26:06.258 > [HTTP] Response code: 400
10:26:06.258 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:06.263 > [HTTP] Request failed with code: 400
10:26:06.265 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:06.272 > [RETRY] Consecutive failures: 3
10:26:06.274 > ✗ Auto-recovery failed - restarting key exchange
10:26:08.374 > [112.3] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:08.381 > ✓ Public key loaded from NVS
10:26:08.477 > [112.4] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:08.577 > [112.5] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:08.585 > Generating fresh master key from entropy...
10:26:08.592 > Generated master key (32): CA2D783249845D0D389C807E9FEB4196 1E7F4CE0824150A7E10287A53857AABF 
10:26:08.598 > Using reduced master key (byte % 3) for NTRU encryption only
10:26:08.609 > NTRU encrypted master key (502): 007800060006007300690000005F0066 00380006007F0018000F0019000B0006 ...
10:26:08.617 > POST http://192.168.137.64:8081/master-key
10:26:08.989 > ✓ Master key exchange completed
10:26:14.095 > [118.1] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.104 > Loading master key from NVS and deriving symmetric keys...
10:26:14.107 > Loaded master key from NVS (32): CA2D783249845D0D389C807E9FEB4196 1E7F4CE0824150A7E10287A53857AABF 
10:26:14.118 > Derived HMAC key (32): F8A97C682EB768A683CA0EE41359D3E4 81EBD42C7D8EA93199850737F5EB6F33
10:26:14.123 > Derived Tinkerbell key (16): 4DBC405406416FEDB14341E76AF40156 
10:26:14.129 > Derived Transposition key (16): 6A1F969EDF8C7491305F1BE243067C67
10:26:14.137 > ✓ Symmetric keys derived successfully
10:26:14.140 > Nonce tracker reset - new session started
10:26:14.143 > ✓ Symmetric keys ready - starting health data transmission
10:26:14.247 > [WebSocket] Disconnected!
10:26:14.248 > [118.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED   
10:26:14.348 > [118.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.448 > [118.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.548 > [118.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.648 > [118.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.748 > [118.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.848 > [118.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:14.947 > [118.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.048 > [119.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.148 > [119.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.249 > [119.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.348 > [119.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.448 > [119.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.548 > [119.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.648 > [119.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.748 > [119.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.849 > [119.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:15.948 > [119.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.047 > [120.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.148 > [120.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.248 > [120.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.348 > [120.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.448 > [120.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.548 > [120.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.648 > [120.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.748 > [120.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.848 > [120.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:16.948 > [120.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.048 > [121.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.148 > [121.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.248 > [121.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.347 > [121.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.448 > [121.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.548 > [121.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.648 > [121.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.748 > [121.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.848 > [121.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:17.947 > [121.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.048 > [122.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.148 > [122.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.247 > [122.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.348 > [122.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.448 > [122.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.548 > [122.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.648 > [122.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.748 > [122.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.848 > [122.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:18.948 > [122.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:19.048 > [123.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:19.148 > [123.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:24.253 > [128.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:24.261 > Generated health data: HR-62 SPO2-95 STEPS-640
10:26:24.264 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:24.269 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:24.275 > Generated health data: HR-62 SPO2-95 STEPS-659
10:26:24.278 > [ESP32] MsgKeys: lfsrSeed=0xC2E96DEE tnk[0..3]=5FF4B102 trn[0..3]=10FE4566
10:26:24.283 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3635394D50
10:26:24.292 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3635394D5000000000000000
10:26:24.298 > [ESP32][LFSR] Initializing - Seed: 0xC2E96DEE SeedBe: 0xEE6DE9C2 ChaosKey[0..3]: 5FF4B102 InitialTap: 0x0029 State: 0xC2E96DEE
10:26:24.308 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
10:26:24.316 > 3_After_LFSR (32): A63FC4F4862DDB3C6E697AB9864A5ECB B480FF9E995778757E65F4834EC06878
10:26:24.325 > [ESP32][LFSR] Keystream (first 16 bytes): EE6DE9C2B40D886C215B5780B36A0D9F
10:26:24.331 > [ESP32][TINKERBELL] Input (first 16 bytes): A63FC4F4862DDB3C6E697AB9864A5ECB Nonce: 0x00000001 Buffer size: 32 bytes
10:26:24.342 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5FF4B102
10:26:24.353 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:24.361 > 4_After_Tinkerbell (32): 3F46D45FFDD4E718AF19FDF3341732A7 A926ADB02B31A56F1DF6671911365CC8 
10:26:24.367 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:24.375 > 5_After_Transposition (32): 191136A926AD32A7D4463F17F334C85C B02B311DF667E718AF19FDD45FFDA56F 
10:26:24.384 > [ESP32] === HMAC DEBUG INFO ===
10:26:24.387 > [ESP32] HMAC Key being used: F8A97C682EB768A683CA0EE41359D3E481EBD42C7D8EA93199850737F5EB6F33
10:26:24.395 > [ESP32] HMAC Input length: 44 bytes
10:26:24.398 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001191136A926AD32A7D4463F17F334C85CB02B311D
10:26:24.409 > [ESP32] Nonce: 0x00000001
10:26:24.409 > [ESP32] Packet size before HMAC: 60
10:26:24.411 > [ESP32] Computed HMAC Tag: 131F487F7AF4CBBC72E6ADF87AF7D9FD
10:26:24.417 > [ESP32] === END HMAC DEBUG ===
10:26:24.419 > 6_Final_Packet (60): 810217001700040800000001191136A9 26AD32A7D4463F17F334C85CB02B311D ...
10:26:24.428 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:24.431 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:24.436 > Sending pipeline data to server (557 bytes)
10:26:24.738 > [HTTP] Response code: 400
10:26:24.738 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:24.743 > [HTTP] Request failed with code: 400
10:26:24.745 > [RETRY] Send failed, waiting 100 ms before retry
10:26:24.842 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:24.843 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:24.848 > Sending pipeline data to server (557 bytes)
10:26:24.989 > [HTTP] Response code: 400
10:26:24.990 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:24.995 > [HTTP] Request failed with code: 400
10:26:24.997 > [RETRY] Send failed, waiting 200 ms before retry
10:26:25.193 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:25.193 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:25.198 > Sending pipeline data to server (557 bytes)
10:26:25.526 > [HTTP] Response code: 400
10:26:25.526 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:25.531 > [HTTP] Request failed with code: 400
10:26:25.534 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:25.540 > [RETRY] Consecutive failures: 4
10:26:25.543 > Health data send failed (retry count: 1/3)
10:26:25.642 > [WebSocket] Disconnected!
10:26:25.642 > [129.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED   
10:26:25.650 > Generated health data: HR-62 SPO2-95 STEPS-661
10:26:25.655 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:25.661 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:25.664 > Generated health data: HR-62 SPO2-95 STEPS-663
10:26:25.670 > [ESP32] MsgKeys: lfsrSeed=0xC2E96DEE tnk[0..3]=5FF4B102 trn[0..3]=10FE4566
10:26:25.675 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3636334D50
10:26:25.680 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3636334D5000000000000000 
10:26:25.689 > [ESP32][LFSR] Initializing - Seed: 0xC2E96DEE SeedBe: 0xEE6DE9C2 ChaosKey[0..3]: 5FF4B102 InitialTap: 0x0029 State: 0xC2E96DEE
10:26:25.700 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
10:26:25.709 > 3_After_LFSR (32): A63FC4F4862DDB3C6E697AB9864A5ECB B480FF9E995472757E65F4834EC06878
10:26:25.717 > [ESP32][LFSR] Keystream (first 16 bytes): EE6DE9C2B40D886C215B5780B36A0D9F
10:26:25.723 > [ESP32][TINKERBELL] Input (first 16 bytes): A63FC4F4862DDB3C6E697AB9864A5ECB Nonce: 0x00000001 Buffer size: 32 bytes
10:26:25.734 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5FF4B102
10:26:25.742 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:25.750 > 4_After_Tinkerbell (32): 3F46D45FFDD4E718AF19FDF3341732A7 A926ADB02B32AF6F1DF6671911365CC8
10:26:25.758 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:25.767 > 5_After_Transposition (32): 191136A926AD32A7D4463F17F334C85C B02B321DF667E718AF19FDD45FFDAF6F      
10:26:25.775 > [ESP32] === HMAC DEBUG INFO ===
10:26:25.778 > [ESP32] HMAC Key being used: F8A97C682EB768A683CA0EE41359D3E481EBD42C7D8EA93199850737F5EB6F33
10:26:25.786 > [ESP32] HMAC Input length: 44 bytes
10:26:25.789 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001191136A926AD32A7D4463F17F334C85CB02B321D
10:26:25.797 > [ESP32] Nonce: 0x00000001
10:26:25.800 > [ESP32] Packet size before HMAC: 60
10:26:25.803 > [ESP32] Computed HMAC Tag: DF0601082781ADE3EFB9D26645D90964
10:26:25.809 > [ESP32] === END HMAC DEBUG ===
10:26:25.811 > 6_Final_Packet (60): 810217001700040800000001191136A9 26AD32A7D4463F17F334C85CB02B321D ...
10:26:25.820 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:25.822 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:25.828 > Sending pipeline data to server (557 bytes)
10:26:25.993 > [HTTP] Response code: 400
10:26:25.993 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:25.998 > [HTTP] Request failed with code: 400
10:26:26.001 > [RETRY] Send failed, waiting 100 ms before retry
10:26:26.097 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:26.097 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:26.102 > Sending pipeline data to server (557 bytes)
10:26:26.244 > [HTTP] Response code: 400
10:26:26.244 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:26.250 > [HTTP] Request failed with code: 400
10:26:26.253 > [RETRY] Send failed, waiting 200 ms before retry
10:26:26.449 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:26.449 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:26.454 > Sending pipeline data to server (557 bytes)
10:26:26.763 > [HTTP] Response code: 400
10:26:26.763 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:26.768 > [HTTP] Request failed with code: 400
10:26:26.771 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:26.777 > [RETRY] Consecutive failures: 5
10:26:26.779 > [EMERGENCY] Triggering emergency reset!
10:26:26.782 > [CRYPTO] Resetting cryptographic state
10:26:26.787 > [CRYPTO] Crypto state reset complete
10:26:26.790 > [CRYPTO] Packet counter: 2
10:26:26.793 > [EMERGENCY] Emergency reset complete
10:26:26.796 > Health data send failed (retry count: 2/3)
10:26:26.900 > [130.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:26.907 > Generated health data: HR-62 SPO2-95 STEPS-687
10:26:26.910 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:26.915 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:26.921 > Generated health data: HR-62 SPO2-95 STEPS-662
10:26:26.924 > [ESP32] MsgKeys: lfsrSeed=0xC2E96DEE tnk[0..3]=5FF4B102 trn[0..3]=10FE4566
10:26:26.929 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3636324D50
10:26:26.938 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3636324D5000000000000000
10:26:26.943 > [ESP32][LFSR] Initializing - Seed: 0xC2E96DEE SeedBe: 0xEE6DE9C2 ChaosKey[0..3]: 5FF4B102 InitialTap: 0x0029 State: 0xC2E96DEE
10:26:26.954 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:26:26.963 > 3_After_LFSR (32): A63FC4F4862DDB3C6E697AB9864A5ECB B480FF9E995473757E65F4834EC06878 
10:26:26.971 > [ESP32][LFSR] Keystream (first 16 bytes): EE6DE9C2B40D886C215B5780B36A0D9F
10:26:26.977 > [ESP32][TINKERBELL] Input (first 16 bytes): A63FC4F4862DDB3C6E697AB9864A5ECB Nonce: 0x00000001 Buffer size: 32 bytes
10:26:26.988 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5FF4B102
10:26:26.999 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:27.008 > 4_After_Tinkerbell (32): 3F46D45FFDD4E718AF19FDF3341732A7 A926ADB02B32AE6F1DF6671911365CC8 
10:26:27.013 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:27.021 > 5_After_Transposition (32): 191136A926AD32A7D4463F17F334C85C B02B321DF667E718AF19FDD45FFDAE6F 
10:26:27.030 > [ESP32] === HMAC DEBUG INFO ===
10:26:27.032 > [ESP32] HMAC Key being used: F8A97C682EB768A683CA0EE41359D3E481EBD42C7D8EA93199850737F5EB6F33      
10:26:27.041 > [ESP32] HMAC Input length: 44 bytes
10:26:27.044 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001191136A926AD32A7D4463F17F334C85CB02B321D
10:26:27.055 > [ESP32] Nonce: 0x00000001
10:26:27.055 > [ESP32] Packet size before HMAC: 60
10:26:27.058 > [ESP32] Computed HMAC Tag: F1C0137F5C76C0A8B29C359D6671591C
10:26:27.063 > [ESP32] === END HMAC DEBUG ===
10:26:27.066 > 6_Final_Packet (60): 810217001700040800000001191136A9 26AD32A7D4463F17F334C85CB02B321D ...
10:26:27.074 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:27.077 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:27.082 > Sending pipeline data to server (557 bytes)
10:26:27.250 > [HTTP] Response code: 400
10:26:27.250 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:27.256 > [HTTP] Request failed with code: 400
10:26:27.259 > [RETRY] Send failed, waiting 100 ms before retry
10:26:27.355 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:27.355 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:27.360 > Sending pipeline data to server (557 bytes)
10:26:27.534 > [HTTP] Response code: 400
10:26:27.534 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:27.540 > [HTTP] Request failed with code: 400
10:26:27.543 > [RETRY] Send failed, waiting 200 ms before retry
10:26:27.739 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:27.739 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:27.745 > Sending pipeline data to server (557 bytes)
10:26:28.001 > [HTTP] Response code: 400
10:26:28.001 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:28.006 > [HTTP] Request failed with code: 400
10:26:28.009 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:28.014 > [RETRY] Consecutive failures: 1
10:26:28.017 > Health data send failed (retry count: 3/3)
10:26:28.020 > Health data transmission failed after max retries
10:26:28.127 > [132.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:28.132 > ERROR state - attempting recovery
10:26:28.135 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:28.140 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:28.145 > Generated health data: HR-62 SPO2-95 STEPS-680
10:26:28.148 > [ESP32] MsgKeys: lfsrSeed=0xC2E96DEE tnk[0..3]=5FF4B102 trn[0..3]=10FE4566
10:26:28.157 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3638304D50
10:26:28.162 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3638304D5000000000000000 
10:26:28.171 > [ESP32][LFSR] Initializing - Seed: 0xC2E96DEE SeedBe: 0xEE6DE9C2 ChaosKey[0..3]: 5FF4B102 InitialTap: 0x0029 State: 0xC2E96DEE
10:26:28.182 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:26:28.190 > 3_After_LFSR (32): A63FC4F4862DDB3C6E697AB9864A5ECB B480FF9E995A71757E65F4834EC06878
10:26:28.195 > [ESP32][LFSR] Keystream (first 16 bytes): EE6DE9C2B40D886C215B5780B36A0D9F
10:26:28.203 > [ESP32][TINKERBELL] Input (first 16 bytes): A63FC4F4862DDB3C6E697AB9864A5ECB Nonce: 0x00000001 Buffer size: 32 bytes
10:26:28.212 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5FF4B102
10:26:28.223 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:28.232 > 4_After_Tinkerbell (32): 3F46D45FFDD4E718AF19FDF3341732A7 A926ADB02B3CAC6F1DF6671911365CC8
10:26:28.240 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 997910AB7BF93C24C170874AB25D6C6C
10:26:28.248 > 5_After_Transposition (32): 191136A926AD32A7D4463F17F334C85C B02B3C1DF667E718AF19FDD45FFDAC6F      
10:26:28.256 > [ESP32] === HMAC DEBUG INFO ===
10:26:28.259 > [ESP32] HMAC Key being used: F8A97C682EB768A683CA0EE41359D3E481EBD42C7D8EA93199850737F5EB6F33
10:26:28.265 > [ESP32] HMAC Input length: 44 bytes
10:26:28.271 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001191136A926AD32A7D4463F17F334C85CB02B3C1D
10:26:28.278 > [ESP32] Nonce: 0x00000001
10:26:28.282 > [ESP32] Packet size before HMAC: 60
10:26:28.285 > [ESP32] Computed HMAC Tag: A8AB4F26400A898420CEDE12CF3DD28A
10:26:28.290 > [ESP32] === END HMAC DEBUG ===
10:26:28.293 > 6_Final_Packet (60): 810217001700040800000001191136A9 26AD32A7D4463F17F334C85CB02B3C1D ...
10:26:28.301 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:28.301 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:28.307 > Sending pipeline data to server (557 bytes)
10:26:28.505 > [HTTP] Response code: 400
10:26:28.505 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:28.510 > [HTTP] Request failed with code: 400
10:26:28.513 > [RETRY] Send failed, waiting 100 ms before retry
10:26:28.608 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:28.609 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:28.614 > Sending pipeline data to server (557 bytes)
10:26:28.988 > [HTTP] Response code: 400
10:26:28.988 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:28.993 > [HTTP] Request failed with code: 400
10:26:28.997 > [RETRY] Send failed, waiting 200 ms before retry
10:26:29.192 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:29.192 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:29.197 > Sending pipeline data to server (557 bytes)
10:26:29.527 > [HTTP] Response code: 400
10:26:29.527 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:29.532 > [HTTP] Request failed with code: 400
10:26:29.534 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:29.540 > [RETRY] Consecutive failures: 2
10:26:29.543 > ✗ Auto-recovery failed - restarting key exchange
10:26:36.645 > [140.6] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:36.654 > ✓ Public key loaded from NVS
10:26:36.749 > [WebSocket] Disconnected!
10:26:36.749 > [140.7] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:36.850 > [140.8] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:36.859 > Generating fresh master key from entropy...
10:26:36.866 > Generated master key (32): 5688BD15699738E0EB941B08A0B09546 75CE23033CD0D57FA47F4155B36755F4 
10:26:36.871 > Using reduced master key (byte % 3) for NTRU encryption only
10:26:36.882 > NTRU encrypted master key (502): 00790007000600710068000100610067 00370007007D001A0010001A000B0007 ...
10:26:36.890 > POST http://192.168.137.64:8081/master-key
10:26:37.580 > ✓ Master key exchange completed
10:26:37.682 > [141.7] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:37.691 > Loading master key from NVS and deriving symmetric keys...
10:26:37.693 > Loaded master key from NVS (32): 5688BD15699738E0EB941B08A0B09546 75CE23033CD0D57FA47F4155B36755F4 
10:26:37.704 > Derived HMAC key (32): EFF155F287E7553481EC860A9EA53668 C4ECD259A95A62FBCC91B19D5BEE6BD1 
10:26:37.709 > Derived Tinkerbell key (16): AF42B2BB70F86EF0F22E3EE601DCDC50
10:26:37.715 > Derived Transposition key (16): BAB66717B9BD3014470DF1526F13908D
10:26:37.724 > ✓ Symmetric keys derived successfully
10:26:37.727 > Nonce tracker reset - new session started
10:26:37.730 > ✓ Symmetric keys ready - starting health data transmission
10:26:37.835 > [141.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:37.936 > [141.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.036 > [142.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.135 > [142.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.236 > [142.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.336 > [142.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.436 > [142.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.536 > [142.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.635 > [142.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.736 > [142.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.836 > [142.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:38.935 > [142.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.035 > [143.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.135 > [143.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.235 > [143.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.336 > [143.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.436 > [143.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.536 > [143.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.636 > [143.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.736 > [143.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.836 > [143.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:39.935 > [143.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.035 > [144.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.135 > [144.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.235 > [144.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.336 > [144.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.436 > [144.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.536 > [144.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.636 > [144.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.736 > [144.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.836 > [144.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:40.935 > [144.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.035 > [145.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.135 > [145.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.236 > [145.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.335 > [145.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.436 > [145.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.535 > [145.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.635 > [145.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:41.735 > [145.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:46.841 > [150.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:46.942 > [WebSocket] Disconnected!
10:26:46.942 > [150.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED   
10:26:47.043 > [151.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.143 > [151.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.243 > [151.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.343 > [151.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.443 > [151.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.543 > [151.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.643 > [151.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.743 > [151.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:47.752 > Generated health data: HR-62 SPO2-95 STEPS-762
10:26:47.754 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:47.759 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:47.765 > Generated health data: HR-62 SPO2-95 STEPS-801
10:26:47.768 > [ESP32] MsgKeys: lfsrSeed=0x67C5C030 tnk[0..3]=5B289696 trn[0..3]=55E557C1
10:26:47.773 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3830314D50
10:26:47.781 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3830314D5000000000000000 
10:26:47.787 > [ESP32][LFSR] Initializing - Seed: 0x67C5C030 SeedBe: 0x30C0C567 ChaosKey[0..3]: 5B289696 InitialTap: 0x0029 State: 0x67C5C030
10:26:47.798 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
10:26:47.807 > 3_After_LFSR (32): 7892E8510F9AA69BE420A75218A4E451 61730FDD0FF13F57E1026AB8959C1F29
10:26:47.815 > [ESP32][LFSR] Keystream (first 16 bytes): 30C0C5673DBAF5CBAB128A6B2D84B705
10:26:47.820 > [ESP32][TINKERBELL] Input (first 16 bytes): 7892E8510F9AA69BE420A75218A4E451 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:47.832 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5B289696
10:26:47.843 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:47.851 > 4_After_Tinkerbell (32): E5DE39C41290E902F71492769F83B8D8 A18D7C3859B6FC57C5872A27DF2EE9E0
10:26:47.857 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:47.865 > 5_After_Transposition (32): DF2EF714E9E07C3859B6E5DEFC572A27 839F87C5D8B8C43990128DA102E97692      
10:26:47.873 > [ESP32] === HMAC DEBUG INFO ===
10:26:47.876 > [ESP32] HMAC Key being used: EFF155F287E7553481EC860A9EA53668C4ECD259A95A62FBCC91B19D5BEE6BD1
10:26:47.885 > [ESP32] HMAC Input length: 44 bytes
10:26:47.887 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DF2EF714E9E07C3859B6E5DEFC572A27839F87C5
10:26:47.898 > [ESP32] Nonce: 0x00000001
10:26:47.898 > [ESP32] Packet size before HMAC: 60
10:26:47.901 > [ESP32] Computed HMAC Tag: 81D206847BC7843BEBE95E99117F692B
10:26:47.907 > [ESP32] === END HMAC DEBUG ===
10:26:47.909 > 6_Final_Packet (60): 810217001700040800000001DF2EF714 E9E07C3859B6E5DEFC572A27839F87C5 ...
10:26:47.918 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:47.920 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:47.926 > Sending pipeline data to server (557 bytes)
10:26:48.436 > [HTTP] Response code: 400
10:26:48.436 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:48.442 > [HTTP] Request failed with code: 400
10:26:48.445 > [RETRY] Send failed, waiting 100 ms before retry
10:26:48.540 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:48.541 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:48.546 > Sending pipeline data to server (557 bytes)
10:26:48.782 > [HTTP] Response code: 400
10:26:48.782 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:48.787 > [HTTP] Request failed with code: 400
10:26:48.790 > [RETRY] Send failed, waiting 200 ms before retry
10:26:48.987 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:48.987 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:48.992 > Sending pipeline data to server (557 bytes)
10:26:49.271 > [HTTP] Response code: 400
10:26:49.271 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:49.277 > [HTTP] Request failed with code: 400
10:26:49.279 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:49.285 > [RETRY] Consecutive failures: 3
10:26:49.287 > Health data send failed (retry count: 1/3)
10:26:49.386 > [153.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:49.395 > Generated health data: HR-62 SPO2-95 STEPS-769
10:26:49.398 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:49.403 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:49.408 > Generated health data: HR-62 SPO2-95 STEPS-766
10:26:49.411 > [ESP32] MsgKeys: lfsrSeed=0x67C5C030 tnk[0..3]=5B289696 trn[0..3]=55E557C1
10:26:49.416 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3736364D50
10:26:49.426 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3736364D5000000000000000 
10:26:49.431 > [ESP32][LFSR] Initializing - Seed: 0x67C5C030 SeedBe: 0x30C0C567 ChaosKey[0..3]: 5B289696 InitialTap: 0x0029 State: 0x67C5C030
10:26:49.442 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
10:26:49.451 > 3_After_LFSR (32): 7892E8510F9AA69BE420A75218A4E451 61730FDD00F73857E1026AB8959C1F29
10:26:49.459 > [ESP32][LFSR] Keystream (first 16 bytes): 30C0C5673DBAF5CBAB128A6B2D84B705
10:26:49.465 > [ESP32][TINKERBELL] Input (first 16 bytes): 7892E8510F9AA69BE420A75218A4E451 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:49.476 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5B289696
10:26:49.487 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:49.495 > 4_After_Tinkerbell (32): E5DE39C41290E902F71492769F83B8D8 A18D7C3856B0FB57C5872A27DF2EE9E0
10:26:49.500 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:49.508 > 5_After_Transposition (32): DF2EF714E9E07C3856B0E5DEFB572A27 839F87C5D8B8C43990128DA102E97692      
10:26:49.517 > [ESP32] === HMAC DEBUG INFO ===
10:26:49.520 > [ESP32] HMAC Key being used: EFF155F287E7553481EC860A9EA53668C4ECD259A95A62FBCC91B19D5BEE6BD1
10:26:49.528 > [ESP32] HMAC Input length: 44 bytes
10:26:49.531 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DF2EF714E9E07C3856B0E5DEFB572A27839F87C5
10:26:49.542 > [ESP32] Nonce: 0x00000001
10:26:49.542 > [ESP32] Packet size before HMAC: 60
10:26:49.545 > [ESP32] Computed HMAC Tag: 1DC847FB6D0BF973A004359D48070F0A
10:26:49.550 > [ESP32] === END HMAC DEBUG ===
10:26:49.553 > 6_Final_Packet (60): 810217001700040800000001DF2EF714 E9E07C3856B0E5DEFB572A27839F87C5 ...
10:26:49.562 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:49.564 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:49.570 > Sending pipeline data to server (557 bytes)
10:26:49.775 > [HTTP] Response code: 400
10:26:49.775 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:49.781 > [HTTP] Request failed with code: 400
10:26:49.783 > [RETRY] Send failed, waiting 100 ms before retry
10:26:49.879 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:49.880 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:49.885 > Sending pipeline data to server (557 bytes)
10:26:50.021 > [HTTP] Response code: 400
10:26:50.021 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:50.026 > [HTTP] Request failed with code: 400
10:26:50.029 > [RETRY] Send failed, waiting 200 ms before retry
10:26:50.225 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:50.225 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:50.230 > Sending pipeline data to server (557 bytes)
10:26:50.556 > [HTTP] Response code: 400
10:26:50.557 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:50.562 > [HTTP] Request failed with code: 400
10:26:50.565 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:50.571 > [RETRY] Consecutive failures: 4
10:26:50.573 > Health data send failed (retry count: 2/3)
10:26:50.672 > [154.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:50.680 > Generated health data: HR-62 SPO2-95 STEPS-783
10:26:50.683 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:50.689 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:50.694 > Generated health data: HR-62 SPO2-95 STEPS-780
10:26:50.697 > [ESP32] MsgKeys: lfsrSeed=0x67C5C030 tnk[0..3]=5B289696 trn[0..3]=55E557C1
10:26:50.703 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3738304D50
10:26:50.711 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3738304D5000000000000000
10:26:50.716 > [ESP32][LFSR] Initializing - Seed: 0x67C5C030 SeedBe: 0x30C0C567 ChaosKey[0..3]: 5B289696 InitialTap: 0x0029 State: 0x67C5C030
10:26:50.728 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:26:50.736 > 3_After_LFSR (32): 7892E8510F9AA69BE420A75218A4E451 61730FDD00F93E57E1026AB8959C1F29 
10:26:50.744 > [ESP32][LFSR] Keystream (first 16 bytes): 30C0C5673DBAF5CBAB128A6B2D84B705
10:26:50.750 > [ESP32][TINKERBELL] Input (first 16 bytes): 7892E8510F9AA69BE420A75218A4E451 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:50.761 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5B289696
10:26:50.773 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:50.781 > 4_After_Tinkerbell (32): E5DE39C41290E902F71492769F83B8D8 A18D7C3856BEFD57C5872A27DF2EE9E0
10:26:50.786 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:50.795 > 5_After_Transposition (32): DF2EF714E9E07C3856BEE5DEFD572A27 839F87C5D8B8C43990128DA102E97692 
10:26:50.803 > [ESP32] === HMAC DEBUG INFO ===
10:26:50.806 > [ESP32] HMAC Key being used: EFF155F287E7553481EC860A9EA53668C4ECD259A95A62FBCC91B19D5BEE6BD1      
10:26:50.814 > [ESP32] HMAC Input length: 44 bytes
10:26:50.817 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DF2EF714E9E07C3856BEE5DEFD572A27839F87C5
10:26:50.828 > [ESP32] Nonce: 0x00000001
10:26:50.828 > [ESP32] Packet size before HMAC: 60
10:26:50.831 > [ESP32] Computed HMAC Tag: F283C838A693AF389CD0815473E7D781
10:26:50.837 > [ESP32] === END HMAC DEBUG ===
10:26:50.840 > 6_Final_Packet (60): 810217001700040800000001DF2EF714 E9E07C3856BEE5DEFD572A27839F87C5 ...
10:26:50.848 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:50.851 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:50.856 > Sending pipeline data to server (557 bytes)
10:26:51.027 > [HTTP] Response code: 400
10:26:51.027 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:51.032 > [HTTP] Request failed with code: 400
10:26:51.035 > [RETRY] Send failed, waiting 100 ms before retry
10:26:51.131 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:51.131 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:51.137 > Sending pipeline data to server (557 bytes)
10:26:51.276 > [HTTP] Response code: 400
10:26:51.276 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:51.282 > [HTTP] Request failed with code: 400
10:26:51.285 > [RETRY] Send failed, waiting 200 ms before retry
10:26:51.480 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:51.480 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:51.486 > Sending pipeline data to server (557 bytes)
10:26:51.781 > [HTTP] Response code: 400
10:26:51.781 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:51.786 > [HTTP] Request failed with code: 400
10:26:51.789 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:51.795 > [RETRY] Consecutive failures: 5
10:26:51.797 > [EMERGENCY] Triggering emergency reset!
10:26:51.800 > [CRYPTO] Resetting cryptographic state
10:26:51.806 > [CRYPTO] Crypto state reset complete
10:26:51.809 > [CRYPTO] Packet counter: 3
10:26:51.812 > [EMERGENCY] Emergency reset complete
10:26:51.815 > Health data send failed (retry count: 3/3)
10:26:51.817 > Health data transmission failed after max retries
10:26:51.919 > [155.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:26:51.924 > ERROR state - attempting recovery
10:26:51.927 > [RETRY] Attempting to send health data (Max retries: 3)
10:26:51.933 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:26:51.938 > Generated health data: HR-62 SPO2-95 STEPS-784
10:26:51.941 > [ESP32] MsgKeys: lfsrSeed=0x67C5C030 tnk[0..3]=5B289696 trn[0..3]=55E557C1
10:26:51.949 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3738344D50
10:26:51.955 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3738344D5000000000000000 
10:26:51.963 > [ESP32][LFSR] Initializing - Seed: 0x67C5C030 SeedBe: 0x30C0C567 ChaosKey[0..3]: 5B289696 InitialTap: 0x0029 State: 0x67C5C030
10:26:51.974 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:26:51.982 > 3_After_LFSR (32): 7892E8510F9AA69BE420A75218A4E451 61730FDD00F93A57E1026AB8959C1F29 
10:26:51.987 > [ESP32][LFSR] Keystream (first 16 bytes): 30C0C5673DBAF5CBAB128A6B2D84B705
10:26:51.996 > [ESP32][TINKERBELL] Input (first 16 bytes): 7892E8510F9AA69BE420A75218A4E451 Nonce: 0x00000001 Buffer size: 32 bytes
10:26:52.005 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5B289696
10:26:52.016 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:52.024 > 4_After_Tinkerbell (32): E5DE39C41290E902F71492769F83B8D8 A18D7C3856BEF957C5872A27DF2EE9E0
10:26:52.033 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D4CD1951D0A4F991334352487275C89
10:26:52.041 > 5_After_Transposition (32): DF2EF714E9E07C3856BEE5DEF9572A27 839F87C5D8B8C43990128DA102E97692      
10:26:52.049 > [ESP32] === HMAC DEBUG INFO ===
10:26:52.052 > [ESP32] HMAC Key being used: EFF155F287E7553481EC860A9EA53668C4ECD259A95A62FBCC91B19D5BEE6BD1      
10:26:52.058 > [ESP32] HMAC Input length: 44 bytes
10:26:52.063 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DF2EF714E9E07C3856BEE5DEF9572A27839F87C5
10:26:52.071 > [ESP32] Nonce: 0x00000001
10:26:52.074 > [ESP32] Packet size before HMAC: 60
10:26:52.077 > [ESP32] Computed HMAC Tag: CE22C61BFE5CEF191B5070BF9773CF33
10:26:52.083 > [ESP32] === END HMAC DEBUG ===
10:26:52.085 > 6_Final_Packet (60): 810217001700040800000001DF2EF714 E9E07C3856BEE5DEF9572A27839F87C5 ...
10:26:52.093 > [RETRY] Attempt 1/3 (nonce: 1)
10:26:52.094 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:52.098 > Sending pipeline data to server (557 bytes)
10:26:52.332 > [HTTP] Response code: 400
10:26:52.332 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:52.337 > [HTTP] Request failed with code: 400
10:26:52.340 > [RETRY] Send failed, waiting 100 ms before retry
10:26:52.436 > [RETRY] Attempt 2/3 (nonce: 1)
10:26:52.436 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:52.441 > Sending pipeline data to server (557 bytes)
10:26:52.799 > [HTTP] Response code: 400
10:26:52.799 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:52.805 > [HTTP] Request failed with code: 400
10:26:52.808 > [RETRY] Send failed, waiting 200 ms before retry
10:26:53.004 > [RETRY] Attempt 3/3 (nonce: 1)
10:26:53.005 > POST http://192.168.137.64:8081/health-data with pipeline data
10:26:53.010 > Sending pipeline data to server (557 bytes)
10:26:53.285 > [HTTP] Response code: 400
10:26:53.285 > [HTTP] Error response: {"error":"Decryption failed"}
10:26:53.290 > [HTTP] Request failed with code: 400
10:26:53.293 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:26:53.299 > [RETRY] Consecutive failures: 1
10:26:53.302 > ✗ Auto-recovery failed - restarting key exchange
10:27:00.406 > [164.4] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:00.413 > ✓ Public key loaded from NVS
10:27:00.509 > [WebSocket] Disconnected!
10:27:00.509 > [164.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:00.610 > [164.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:00.618 > Generating fresh master key from entropy...
10:27:00.624 > Generated master key (32): 8005ED175089B28F146FC34B5FB81B41 5F96EF4F4D8C851B59E08E59154719E7       
10:27:00.631 > Using reduced master key (byte % 3) for NTRU encryption only
10:27:00.641 > NTRU encrypted master key (502): 0079000800060073006A000200600067 00380006007D00180011001900090008 ...
10:27:00.650 > POST http://192.168.137.64:8081/master-key
10:27:01.038 > ✓ Master key exchange completed
10:27:01.140 > [165.1] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.148 > Loading master key from NVS and deriving symmetric keys...
10:27:01.150 > Loaded master key from NVS (32): 8005ED175089B28F146FC34B5FB81B41 5F96EF4F4D8C851B59E08E59154719E7 
10:27:01.162 > Derived HMAC key (32): 33B06C8C4F158C84CED1E9B4F1501D4D 3DE2357380775B546775B7F11B346C06 
10:27:01.167 > Derived Tinkerbell key (16): 6C17AFB5E9A1C5DB82332FAFCB8868D1
10:27:01.173 > Derived Transposition key (16): 405B61A89F4C2BFB02F942C129A2FAA4
10:27:01.181 > ✓ Symmetric keys derived successfully
10:27:01.184 > Nonce tracker reset - new session started
10:27:01.186 > ✓ Symmetric keys ready - starting health data transmission
10:27:01.291 > [165.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.392 > [165.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.493 > [165.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.592 > [165.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.692 > [165.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.793 > [165.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.893 > [165.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:01.993 > [166.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.092 > [166.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.193 > [166.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.293 > [166.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.392 > [166.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.492 > [166.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.592 > [166.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.692 > [166.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.793 > [166.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.892 > [166.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:02.993 > [167.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.092 > [167.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.192 > [167.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.292 > [167.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.393 > [167.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.493 > [167.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.593 > [167.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.693 > [167.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.792 > [167.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.893 > [167.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:03.993 > [168.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.092 > [168.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.192 > [168.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.293 > [168.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.393 > [168.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.493 > [168.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.593 > [168.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.693 > [168.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.792 > [168.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.892 > [168.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:04.992 > [169.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:05.092 > [169.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:05.192 > [169.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:05.293 > [169.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:05.393 > [169.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:05.493 > [169.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:10.598 > [174.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:10.700 > [WebSocket] Disconnected!
10:27:10.700 > [174.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:10.800 > [174.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:10.901 > [174.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:11.000 > [175.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:11.100 > [175.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:11.200 > [175.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:11.209 > Generated health data: HR-62 SPO2-95 STEPS-882
10:27:11.212 > [RETRY] Attempting to send health data (Max retries: 3)
10:27:11.217 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:27:11.222 > Generated health data: HR-62 SPO2-95 STEPS-883
10:27:11.225 > [ESP32] MsgKeys: lfsrSeed=0x27CA2917 tnk[0..3]=3FDD890F trn[0..3]=87183A68
10:27:11.231 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3838334D50
10:27:11.239 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3838334D5000000000000000
10:27:11.245 > [ESP32][LFSR] Initializing - Seed: 0x27CA2917 SeedBe: 0x1729CA27 ChaosKey[0..3]: 3FDD890F InitialTap: 0x0029 State: 0x27CA2917
10:27:11.255 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:27:11.264 > 3_After_LFSR (32): 5F7BE71161D87F58BE7EC0F0227D08B3 A16D10C25EBB0B61BDEB66B6815C355A 
10:27:11.273 > [ESP32][LFSR] Keystream (first 16 bytes): 1729CA2753F82C08F14CEDC9175D5BE7
10:27:11.278 > [ESP32][TINKERBELL] Input (first 16 bytes): 5F7BE71161D87F58BE7EC0F0227D08B3 Nonce: 0x00000001 Buffer size: 32 bytes
10:27:11.289 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FDD890F
10:27:11.300 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:11.309 > 4_After_Tinkerbell (32): EB6FD8C68E0E01BC969FDF59BF799D0A 44ABD61C6EEB4A72E4A08823C55269C9 
10:27:11.314 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:11.323 > 5_After_Transposition (32): 9F0EE44ABF230AD86F7944696E1CBCDF ABEB9601C55972D6A052EB9D8EC6C988 
10:27:11.331 > [ESP32] === HMAC DEBUG INFO ===
10:27:11.334 > [ESP32] HMAC Key being used: 33B06C8C4F158C84CED1E9B4F1501D4D3DE2357380775B546775B7F11B346C06      
10:27:11.342 > [ESP32] HMAC Input length: 44 bytes
10:27:11.345 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000019F0EE44ABF230AD86F7944696E1CBCDFABEB9601
10:27:11.356 > [ESP32] Nonce: 0x00000001
10:27:11.356 > [ESP32] Packet size before HMAC: 60
10:27:11.359 > [ESP32] Computed HMAC Tag: 2EAE638BE85A779497891C631D365C7B
10:27:11.364 > [ESP32] === END HMAC DEBUG ===
10:27:11.367 > 6_Final_Packet (60): 8102170017000408000000019F0EE44A BF230AD86F7944696E1CBCDFABEB9601 ...
10:27:11.376 > [RETRY] Attempt 1/3 (nonce: 1)
10:27:11.378 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:11.384 > Sending pipeline data to server (557 bytes)
10:27:11.539 > [HTTP] Response code: 400
10:27:11.539 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:11.545 > [HTTP] Request failed with code: 400
10:27:11.548 > [RETRY] Send failed, waiting 100 ms before retry
10:27:11.645 > [RETRY] Attempt 2/3 (nonce: 1)
10:27:11.646 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:11.651 > Sending pipeline data to server (557 bytes)
10:27:11.817 > [HTTP] Response code: 400
10:27:11.817 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:11.822 > [HTTP] Request failed with code: 400
10:27:11.825 > [RETRY] Send failed, waiting 200 ms before retry
10:27:12.020 > [RETRY] Attempt 3/3 (nonce: 1)
10:27:12.021 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:12.026 > Sending pipeline data to server (557 bytes)
10:27:12.303 > [HTTP] Response code: 400
10:27:12.303 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:12.308 > [HTTP] Request failed with code: 400
10:27:12.311 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:27:12.317 > [RETRY] Consecutive failures: 2
10:27:12.319 > Health data send failed (retry count: 1/3)
10:27:12.418 > [176.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:12.426 > Generated health data: HR-62 SPO2-95 STEPS-912
10:27:12.429 > [RETRY] Attempting to send health data (Max retries: 3)
10:27:12.435 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:27:12.440 > Generated health data: HR-62 SPO2-95 STEPS-896
10:27:12.443 > [ESP32] MsgKeys: lfsrSeed=0x27CA2917 tnk[0..3]=3FDD890F trn[0..3]=87183A68
10:27:12.449 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3839364D50
10:27:12.456 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3839364D5000000000000000 
10:27:12.462 > [ESP32][LFSR] Initializing - Seed: 0x27CA2917 SeedBe: 0x1729CA27 ChaosKey[0..3]: 3FDD890F InitialTap: 0x0029 State: 0x27CA2917
10:27:12.473 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
10:27:12.482 > 3_After_LFSR (32): 5F7BE71161D87F58BE7EC0F0227D08B3 A16D10C25EBA0E61BDEB66B6815C355A
10:27:12.490 > [ESP32][LFSR] Keystream (first 16 bytes): 1729CA2753F82C08F14CEDC9175D5BE7
10:27:12.496 > [ESP32][TINKERBELL] Input (first 16 bytes): 5F7BE71161D87F58BE7EC0F0227D08B3 Nonce: 0x00000001 Buffer size: 32 bytes
10:27:12.506 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FDD890F
10:27:12.518 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:12.526 > 4_After_Tinkerbell (32): EB6FD8C68E0E01BC969FDF59BF799D0A 44ABD61C6EEA4F72E4A08823C55269C9
10:27:12.532 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:12.540 > 5_After_Transposition (32): 9F0EE44FBF230AD86F7944696E1CBCDF ABEA9601C55972D6A052EB9D8EC6C988      
10:27:12.549 > [ESP32] === HMAC DEBUG INFO ===
10:27:12.551 > [ESP32] HMAC Key being used: 33B06C8C4F158C84CED1E9B4F1501D4D3DE2357380775B546775B7F11B346C06
10:27:12.558 > [ESP32] HMAC Input length: 44 bytes
10:27:12.562 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000019F0EE44FBF230AD86F7944696E1CBCDFABEA9601
10:27:12.574 > [ESP32] Nonce: 0x00000001
10:27:12.574 > [ESP32] Packet size before HMAC: 60
10:27:12.576 > [ESP32] Computed HMAC Tag: 6FA49CE6EAC8825738A3F8460E0414E4
10:27:12.582 > [ESP32] === END HMAC DEBUG ===
10:27:12.584 > 6_Final_Packet (60): 8102170017000408000000019F0EE44F BF230AD86F7944696E1CBCDFABEA9601 ...
10:27:12.593 > [RETRY] Attempt 1/3 (nonce: 1)
10:27:12.595 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:12.601 > Sending pipeline data to server (557 bytes)
10:27:12.795 > [HTTP] Response code: 400
10:27:12.795 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:12.801 > [HTTP] Request failed with code: 400
10:27:12.803 > [RETRY] Send failed, waiting 100 ms before retry
10:27:12.899 > [RETRY] Attempt 2/3 (nonce: 1)
10:27:12.900 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:12.905 > Sending pipeline data to server (557 bytes)
10:27:13.049 > [HTTP] Response code: 400
10:27:13.050 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:13.055 > [HTTP] Request failed with code: 400
10:27:13.057 > [RETRY] Send failed, waiting 200 ms before retry
10:27:13.253 > [RETRY] Attempt 3/3 (nonce: 1)
10:27:13.253 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:13.259 > Sending pipeline data to server (557 bytes)
10:27:13.553 > [HTTP] Response code: 400
10:27:13.553 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:13.558 > [HTTP] Request failed with code: 400
10:27:13.562 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:27:13.567 > [RETRY] Consecutive failures: 3
10:27:13.569 > Health data send failed (retry count: 2/3)
10:27:13.669 > [177.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:13.677 > Generated health data: HR-62 SPO2-95 STEPS-901
10:27:13.680 > [RETRY] Attempting to send health data (Max retries: 3)
10:27:13.685 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:27:13.691 > Generated health data: HR-62 SPO2-95 STEPS-929
10:27:13.694 > [ESP32] MsgKeys: lfsrSeed=0x27CA2917 tnk[0..3]=3FDD890F trn[0..3]=87183A68
10:27:13.699 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3932394D50
10:27:13.707 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3932394D5000000000000000
10:27:13.713 > [ESP32][LFSR] Initializing - Seed: 0x27CA2917 SeedBe: 0x1729CA27 ChaosKey[0..3]: 3FDD890F InitialTap: 0x0029 State: 0x27CA2917
10:27:13.724 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:27:13.733 > 3_After_LFSR (32): 5F7BE71161D87F58BE7EC0F0227D08B3 A16D10C25FB10161BDEB66B6815C355A 
10:27:13.741 > [ESP32][LFSR] Keystream (first 16 bytes): 1729CA2753F82C08F14CEDC9175D5BE7
10:27:13.747 > [ESP32][TINKERBELL] Input (first 16 bytes): 5F7BE71161D87F58BE7EC0F0227D08B3 Nonce: 0x00000001 Buffer size: 32 bytes
10:27:13.758 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FDD890F
10:27:13.768 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:13.777 > 4_After_Tinkerbell (32): EB6FD8C68E0E01BC969FDF59BF799D0A 44ABD61C6FE14072E4A08823C55269C9 
10:27:13.783 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:13.791 > 5_After_Transposition (32): 9F0EE440BF230AD86F7944696F1CBCDF ABE19601C55972D6A052EB9D8EC6C988 
10:27:13.799 > [ESP32] === HMAC DEBUG INFO ===
10:27:13.802 > [ESP32] HMAC Key being used: 33B06C8C4F158C84CED1E9B4F1501D4D3DE2357380775B546775B7F11B346C06      
10:27:13.811 > [ESP32] HMAC Input length: 44 bytes
10:27:13.813 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000019F0EE440BF230AD86F7944696F1CBCDFABE19601
10:27:13.824 > [ESP32] Nonce: 0x00000001
10:27:13.824 > [ESP32] Packet size before HMAC: 60
10:27:13.827 > [ESP32] Computed HMAC Tag: 8EC31B7CB8888AD9EE9A217DB41A0AB3
10:27:13.833 > [ESP32] === END HMAC DEBUG ===
10:27:13.835 > 6_Final_Packet (60): 8102170017000408000000019F0EE440 BF230AD86F7944696F1CBCDFABE19601 ...
10:27:13.844 > [RETRY] Attempt 1/3 (nonce: 1)
10:27:13.847 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:13.852 > Sending pipeline data to server (557 bytes)
10:27:14.062 > [HTTP] Response code: 400
10:27:14.062 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:14.067 > [HTTP] Request failed with code: 400
10:27:14.070 > [RETRY] Send failed, waiting 100 ms before retry
10:27:14.167 > [RETRY] Attempt 2/3 (nonce: 1)
10:27:14.167 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:14.171 > Sending pipeline data to server (557 bytes)
10:27:14.306 > [HTTP] Response code: 400
10:27:14.306 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:14.311 > [HTTP] Request failed with code: 400
10:27:14.314 > [RETRY] Send failed, waiting 200 ms before retry
10:27:14.511 > [RETRY] Attempt 3/3 (nonce: 1)
10:27:14.511 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:14.517 > Sending pipeline data to server (557 bytes)
10:27:14.807 > [HTTP] Response code: 400
10:27:14.807 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:14.813 > [HTTP] Request failed with code: 400
10:27:14.815 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:27:14.821 > [RETRY] Consecutive failures: 4
10:27:14.823 > Health data send failed (retry count: 3/3)
10:27:14.826 > Health data transmission failed after max retries
10:27:14.933 > [178.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: DISCONNECTED
10:27:14.939 > ERROR state - attempting recovery
10:27:14.941 > [RETRY] Attempting to send health data (Max retries: 3)
10:27:14.947 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:27:14.952 > Generated health data: HR-62 SPO2-95 STEPS-919
10:27:14.955 > [ESP32] MsgKeys: lfsrSeed=0x27CA2917 tnk[0..3]=3FDD890F trn[0..3]=87183A68
10:27:14.964 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3931394D50
10:27:14.968 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3931394D5000000000000000 
10:27:14.977 > [ESP32][LFSR] Initializing - Seed: 0x27CA2917 SeedBe: 0x1729CA27 ChaosKey[0..3]: 3FDD890F InitialTap: 0x0029 State: 0x27CA2917
10:27:14.989 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes       
10:27:14.997 > 3_After_LFSR (32): 5F7BE71161D87F58BE7EC0F0227D08B3 A16D10C25FB20161BDEB66B6815C355A 
10:27:15.002 > [ESP32][LFSR] Keystream (first 16 bytes): 1729CA2753F82C08F14CEDC9175D5BE7
10:27:15.011 > [ESP32][TINKERBELL] Input (first 16 bytes): 5F7BE71161D87F58BE7EC0F0227D08B3 Nonce: 0x00000001 Buffer size: 32 bytes
10:27:15.019 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FDD890F
10:27:15.030 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:15.038 > 4_After_Tinkerbell (32): EB6FD8C68E0E01BC969FDF59BF799D0A 44ABD61C6FE24072E4A08823C55269C9
10:27:15.047 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B4143FD7EFD67EE428E11FA99D0495B9
10:27:15.055 > 5_After_Transposition (32): 9F0EE440BF230AD86F7944696F1CBCDF ABE29601C55972D6A052EB9D8EC6C988      
10:27:15.063 > [ESP32] === HMAC DEBUG INFO ===
10:27:15.066 > [ESP32] HMAC Key being used: 33B06C8C4F158C84CED1E9B4F1501D4D3DE2357380775B546775B7F11B346C06
10:27:15.072 > [ESP32] HMAC Input length: 44 bytes
10:27:15.077 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000019F0EE440BF230AD86F7944696F1CBCDFABE29601
10:27:15.085 > [ESP32] Nonce: 0x00000001
10:27:15.088 > [ESP32] Packet size before HMAC: 60
10:27:15.091 > [ESP32] Computed HMAC Tag: 54E1941729BD10A137CDCC683D6D1B0B
10:27:15.096 > [ESP32] === END HMAC DEBUG ===
10:27:15.100 > 6_Final_Packet (60): 8102170017000408000000019F0EE440 BF230AD86F7944696F1CBCDFABE29601 ...
10:27:15.107 > [RETRY] Attempt 1/3 (nonce: 1)
10:27:15.108 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:15.113 > Sending pipeline data to server (557 bytes)
10:27:15.371 > [HTTP] Response code: 400
10:27:15.372 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:15.377 > [HTTP] Request failed with code: 400
10:27:15.380 > [RETRY] Send failed, waiting 100 ms before retry
10:27:15.476 > [RETRY] Attempt 2/3 (nonce: 1)
10:27:15.476 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:15.481 > Sending pipeline data to server (557 bytes)
10:27:15.830 > [HTTP] Response code: 400
10:27:15.830 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:15.835 > [HTTP] Request failed with code: 400
10:27:15.838 > [RETRY] Send failed, waiting 200 ms before retry
10:27:16.035 > [RETRY] Attempt 3/3 (nonce: 1)
10:27:16.036 > POST http://192.168.137.64:8081/health-data with pipeline data
10:27:16.040 > Sending pipeline data to server (557 bytes)
10:27:16.364 > [HTTP] Response code: 400
10:27:16.364 > [HTTP] Error response: {"error":"Decryption failed"}
10:27:16.368 > [HTTP] Request failed with code: 400
10:27:16.372 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:27:16.378 > [RETRY] Consecutive failures: 5
10:27:16.380 > [EMERGENCY] Triggering emergency reset!
10:27:16.383 > [CRYPTO] Resetting cryptographic state
10:27:16.388 > [CRYPTO] Crypto state reset complete
10:27:16.392 > [CRYPTO] Packet counter: 4
10:27:16.395 > [EMERGENCY] Emergency reset complete
10:27:16.397 > ✗ Auto-recovery failed - restarting key exchange
10:29:01.515 > [285.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:01.552 > Generated health data: HR-64 SPO2-95 STEPS-1450
10:29:01.552 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:01.552 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:01.552 > Generated health data: HR-64 SPO2-95 STEPS-1455
10:29:01.552 > [ESP32] MsgKeys: lfsrSeed=0x8A2CEF82 tnk[0..3]=CB5807B7 trn[0..3]=29B745DA
10:29:01.552 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313435354D50
10:29:01.556 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313435354D50000000000000 
10:29:01.561 > [ESP32][LFSR] Initializing - Seed: 0x8A2CEF82 SeedBe: 0x82EF2C8A ChaosKey[0..3]: CB5807B7 InitialTap: 0x0029 State: 0x8A2CEF82
10:29:01.572 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
10:29:01.580 > 3_After_LFSR (32): CABD01BC5A721FA58605F9FDA401444B 9DD5823298F00625B5CB197977474B09
10:29:01.589 > [ESP32][LFSR] Keystream (first 16 bytes): 82EF2C8A6E524CF5C937D4C49121171F
10:29:01.595 > [ESP32][TINKERBELL] Input (first 16 bytes): CABD01BC5A721FA58605F9FDA401444B Nonce: 0x00000001 Buffer size: 32 bytes
10:29:01.605 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: CB5807B7
10:29:01.616 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B1405C0821B5467DF9D2DF451F348245
10:29:01.622 > 4_After_Tinkerbell (32): 7BFD5DB47BC759D87FD726B8BB35C60E 2553929FBF877AC00AD418D71557F274 
10:29:01.631 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B1405C0821B5467DF9D2DF451F348245
10:29:01.638 > 5_After_Transposition (32): BB35C60E0AD418D77BC759D82553929F BF877AC07FD726B81557F2747BFD5DB4      
10:29:01.647 > [ESP32] === HMAC DEBUG INFO ===
10:29:01.650 > [ESP32] HMAC Key being used: CBA3204182FB685B14B9023A46D97B28C0B3B8D4523FFAAB090E8C154EF2F151
10:29:01.658 > [ESP32] HMAC Input length: 44 bytes
10:29:01.661 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001BB35C60E0AD418D77BC759D82553929FBF877AC0
10:29:01.669 > [ESP32] Nonce: 0x00000001
10:29:01.672 > [ESP32] Packet size before HMAC: 60
10:29:01.674 > [ESP32] Computed HMAC Tag: D06E15B3423B38AA9207FB18E9E4E050
10:29:01.680 > [ESP32] === END HMAC DEBUG ===
10:29:01.683 > 6_Final_Packet (60): 810218001800040800000001BB35C60E 0AD418D77BC759D82553929FBF877AC0 ...
10:29:01.692 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:01.695 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:01.700 > Sending pipeline data to server (560 bytes)
10:29:01.907 > [HTTP] Response code: 400
10:29:01.907 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:01.913 > [HTTP] Request failed with code: 400
10:29:01.916 > [RETRY] Send failed, waiting 100 ms before retry
10:29:02.011 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:02.011 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:02.016 > Sending pipeline data to server (560 bytes)
10:29:02.324 > [HTTP] Response code: 400
10:29:02.324 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:02.330 > [HTTP] Request failed with code: 400
10:29:02.332 > [RETRY] Send failed, waiting 200 ms before retry
10:29:02.528 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:02.528 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:02.534 > Sending pipeline data to server (560 bytes)
10:29:02.910 > [HTTP] Response code: 400
10:29:02.911 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:02.916 > [HTTP] Request failed with code: 400
10:29:02.918 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:02.924 > [RETRY] Consecutive failures: 2
10:29:02.927 > Health data send failed (retry count: 3/3)
10:29:02.929 > Health data transmission failed after max retries
10:29:03.035 > [287.0] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:03.040 > ERROR state - attempting recovery
10:29:03.043 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:03.049 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:03.054 > Generated health data: HR-64 SPO2-95 STEPS-1472
10:29:03.058 > [ESP32] MsgKeys: lfsrSeed=0x8A2CEF82 tnk[0..3]=CB5807B7 trn[0..3]=29B745DA
10:29:03.066 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313437324D50
10:29:03.072 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313437324D50000000000000 
10:29:03.080 > [ESP32][LFSR] Initializing - Seed: 0x8A2CEF82 SeedBe: 0x82EF2C8A ChaosKey[0..3]: CB5807B7 InitialTap: 0x0029 State: 0x8A2CEF82
10:29:03.090 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes       
10:29:03.099 > 3_After_LFSR (32): CABD01BC5A721FA58605F9FDA401444B 9DD5823298F00422B5CB197977474B09 
10:29:03.104 > [ESP32][LFSR] Keystream (first 16 bytes): 82EF2C8A6E524CF5C937D4C49121171F
10:29:03.113 > [ESP32][TINKERBELL] Input (first 16 bytes): CABD01BC5A721FA58605F9FDA401444B Nonce: 0x00000001 Buffer size: 32 bytes
10:29:03.121 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: CB5807B7
10:29:03.132 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B1405C0821B5467DF9D2DF451F348245
10:29:03.140 > 4_After_Tinkerbell (32): 7BFD5DB47BC759D87FD726B8BB35C60E 2553929FBF8778C70AD418D71557F274
10:29:03.149 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B1405C0821B5467DF9D2DF451F348245
10:29:03.158 > 5_After_Transposition (32): BB35C60E0AD418D77BC759D82553929F BF8778C77FD726B81557F2747BFD5DB4      
10:29:03.166 > [ESP32] === HMAC DEBUG INFO ===
10:29:03.169 > [ESP32] HMAC Key being used: CBA3204182FB685B14B9023A46D97B28C0B3B8D4523FFAAB090E8C154EF2F151      
10:29:03.177 > [ESP32] HMAC Input length: 44 bytes
10:29:03.180 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001BB35C60E0AD418D77BC759D82553929FBF8778C7
10:29:03.188 > [ESP32] Nonce: 0x00000001
10:29:03.191 > [ESP32] Packet size before HMAC: 60
10:29:03.194 > [ESP32] Computed HMAC Tag: 6ACED6FF84DA5364E9039C58A822BD6B
10:29:03.199 > [ESP32] === END HMAC DEBUG ===
10:29:03.202 > 6_Final_Packet (60): 810218001800040800000001BB35C60E 0AD418D77BC759D82553929FBF8778C7 ...
10:29:03.211 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:03.213 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:03.219 > Sending pipeline data to server (560 bytes)
10:29:03.406 > [HTTP] Response code: 400
10:29:03.406 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:03.412 > [HTTP] Request failed with code: 400
10:29:03.415 > [RETRY] Send failed, waiting 100 ms before retry
10:29:03.510 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:03.510 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:03.516 > Sending pipeline data to server (560 bytes)
10:29:03.798 > [HTTP] Response code: 400
10:29:03.798 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:03.804 > [HTTP] Request failed with code: 400
10:29:03.806 > [RETRY] Send failed, waiting 200 ms before retry
10:29:04.002 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:04.002 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:04.008 > Sending pipeline data to server (560 bytes)
10:29:04.349 > [HTTP] Response code: 400
10:29:04.349 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:04.354 > [HTTP] Request failed with code: 400
10:29:04.357 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:04.362 > [RETRY] Consecutive failures: 3
10:29:04.365 > ✗ Auto-recovery failed - restarting key exchange
10:29:06.464 > [290.4] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:06.471 > ✓ Public key loaded from NVS
10:29:11.573 > [295.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:11.674 > [WebSocket] Disconnected!
10:29:11.674 > [295.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED 
10:29:11.682 > Generating fresh master key from entropy...
10:29:11.688 > Generated master key (32): B6480BCACBBCECACC91443C10FC48DBC 1F75518DC4FB6677577E48D6F710076F 
10:29:11.698 > Using reduced master key (byte % 3) for NTRU encryption only
10:29:11.707 > NTRU encrypted master key (502): 0079000600080072006A000200610066 00360008007E0019000F001900090008 ...
10:29:11.715 > POST http://192.168.137.64:8081/master-key
10:29:11.913 > ✓ Master key exchange completed
10:29:12.015 > [296.0] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.023 > Loading master key from NVS and deriving symmetric keys...
10:29:12.025 > Loaded master key from NVS (32): B6480BCACBBCECACC91443C10FC48DBC 1F75518DC4FB6677577E48D6F710076F 
10:29:12.037 > Derived HMAC key (32): 4E7C22CE433F9AEB284F739C24D45A12 1356CCE254FF6595F8F4BDCA3DCC0AB9 
10:29:12.043 > Derived Tinkerbell key (16): 35C9886D16759A28C864C892380A236A
10:29:12.048 > Derived Transposition key (16): 7D6B26AB54408B18D78A80DCE702AA1F
10:29:12.055 > ✓ Symmetric keys derived successfully
10:29:12.058 > Nonce tracker reset - new session started
10:29:12.061 > ✓ Symmetric keys ready - starting health data transmission
10:29:12.167 > [296.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.267 > [296.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.367 > [296.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.468 > [296.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.567 > [296.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.667 > [296.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.767 > [296.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.868 > [296.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:12.968 > [296.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.067 > [297.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.167 > [297.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.267 > [297.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.367 > [297.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.468 > [297.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.568 > [297.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.667 > [297.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.768 > [297.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.868 > [297.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:13.968 > [297.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.067 > [298.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.167 > [298.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.267 > [298.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.368 > [298.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.467 > [298.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.567 > [298.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.667 > [298.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.767 > [298.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.867 > [298.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:14.967 > [298.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.067 > [299.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.167 > [299.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.267 > [299.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.368 > [299.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.468 > [299.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.567 > [299.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.667 > [299.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.767 > [299.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.867 > [299.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:15.967 > [299.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.067 > [300.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.167 > [300.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.267 > [300.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.367 > [300.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.467 > [300.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.567 > [300.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:16.668 > [300.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:21.774 > [305.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:21.875 > [WebSocket] Disconnected!
10:29:21.875 > [305.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED   
10:29:21.975 > [306.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:22.076 > [306.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:22.084 > Generated health data: HR-65 SPO2-96 STEPS-1576
10:29:22.086 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:22.092 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:22.097 > Generated health data: HR-65 SPO2-96 STEPS-1559
10:29:22.100 > [ESP32] MsgKeys: lfsrSeed=0xBA070CDD tnk[0..3]=92506E0B trn[0..3]=E2BDB0B3
10:29:22.106 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313535394D50
10:29:22.114 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313535394D50000000000000
10:29:22.123 > [ESP32][LFSR] Initializing - Seed: 0xBA070CDD SeedBe: 0xDD0C07BA ChaosKey[0..3]: 92506E0B InitialTap: 0x0029 State: 0xBA070CDD
10:29:22.130 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes       
10:29:22.139 > 3_After_LFSR (32): 955E2A8C95D4C1EFA1A352ED0C5D400F 4FD86644F56DAD838BDCACD9BC10A55E 
10:29:22.147 > [ESP32][LFSR] Keystream (first 16 bytes): DD0C07BAA0F492BFEE917FD43A7D135B
10:29:22.153 > [ESP32][TINKERBELL] Input (first 16 bytes): 955E2A8C95D4C1EFA1A352ED0C5D400F Nonce: 0x00000001 Buffer size: 32 bytes
10:29:22.164 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 92506E0B
10:29:22.175 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:22.184 > 4_After_Tinkerbell (32): 08D66BE99EAFDC64EF6D89DD54E733FA 2498485B4A2EECFE0C7709C159803DCF
10:29:22.192 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:22.197 > 5_After_Transposition (32): 5B48AF9E08D664DCE96BE754EF6DFA33 DD892E4A2498FEEC09C1770C59803DCF      
10:29:22.206 > [ESP32] === HMAC DEBUG INFO ===
10:29:22.208 > [ESP32] HMAC Key being used: 4E7C22CE433F9AEB284F739C24D45A121356CCE254FF6595F8F4BDCA3DCC0AB9      
10:29:22.217 > [ESP32] HMAC Input length: 44 bytes
10:29:22.219 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000015B48AF9E08D664DCE96BE754EF6DFA33DD892E4A
10:29:22.231 > [ESP32] Nonce: 0x00000001
10:29:22.231 > [ESP32] Packet size before HMAC: 60
10:29:22.236 > [ESP32] Computed HMAC Tag: 4293C5A3EB54595A8CE8FC79028A9110
10:29:22.242 > [ESP32] === END HMAC DEBUG ===
10:29:22.242 > 6_Final_Packet (60): 8102180018000408000000015B48AF9E 08D664DCE96BE754EF6DFA33DD892E4A ...
10:29:22.250 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:22.253 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:22.259 > Sending pipeline data to server (560 bytes)
10:29:22.420 > [HTTP] Response code: 400
10:29:22.420 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:22.425 > [HTTP] Request failed with code: 400
10:29:22.428 > [RETRY] Send failed, waiting 100 ms before retry
10:29:22.524 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:22.525 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:22.529 > Sending pipeline data to server (560 bytes)
10:29:22.965 > [HTTP] Response code: 400
10:29:22.965 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:22.969 > [HTTP] Request failed with code: 400
10:29:22.972 > [RETRY] Send failed, waiting 200 ms before retry
10:29:23.169 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:23.169 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:23.174 > Sending pipeline data to server (560 bytes)
10:29:23.420 > [HTTP] Response code: 400
10:29:23.420 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:23.425 > [HTTP] Request failed with code: 400
10:29:23.428 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:23.433 > [RETRY] Consecutive failures: 4
10:29:23.436 > Health data send failed (retry count: 1/3)
10:29:23.535 > [307.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:23.544 > Generated health data: HR-65 SPO2-96 STEPS-1542
10:29:23.546 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:23.552 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:23.557 > Generated health data: HR-65 SPO2-96 STEPS-1547
10:29:23.560 > [ESP32] MsgKeys: lfsrSeed=0xBA070CDD tnk[0..3]=92506E0B trn[0..3]=E2BDB0B3
10:29:23.565 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313534374D50
10:29:23.574 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313534374D50000000000000
10:29:23.582 > [ESP32][LFSR] Initializing - Seed: 0xBA070CDD SeedBe: 0xDD0C07BA ChaosKey[0..3]: 92506E0B InitialTap: 0x0029 State: 0xBA070CDD
10:29:23.591 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:29:23.599 > 3_After_LFSR (32): 955E2A8C95D4C1EFA1A352ED0C5D400F 4FD86644F56DAC8D8BDCACD9BC10A55E
10:29:23.607 > [ESP32][LFSR] Keystream (first 16 bytes): DD0C07BAA0F492BFEE917FD43A7D135B
10:29:23.613 > [ESP32][TINKERBELL] Input (first 16 bytes): 955E2A8C95D4C1EFA1A352ED0C5D400F Nonce: 0x00000001 Buffer size: 32 bytes
10:29:23.624 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 92506E0B
10:29:23.635 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:23.643 > 4_After_Tinkerbell (32): 08D66BE99EAFDC64EF6D89DD54E733FA 2498485B4A2EEDF00C7709C159803DCF
10:29:23.652 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:23.657 > 5_After_Transposition (32): 5B48AF9E08D664DCE96BE754EF6DFA33 DD892E4A2498F0ED09C1770C59803DCF      
10:29:23.666 > [ESP32] === HMAC DEBUG INFO ===
10:29:23.668 > [ESP32] HMAC Key being used: 4E7C22CE433F9AEB284F739C24D45A121356CCE254FF6595F8F4BDCA3DCC0AB9
10:29:23.676 > [ESP32] HMAC Input length: 44 bytes
10:29:23.679 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000015B48AF9E08D664DCE96BE754EF6DFA33DD892E4A
10:29:23.691 > [ESP32] Nonce: 0x00000001
10:29:23.691 > [ESP32] Packet size before HMAC: 60
10:29:23.696 > [ESP32] Computed HMAC Tag: 789FC8BBDCB74B8A59CE168BC56A2FAC
10:29:23.701 > [ESP32] === END HMAC DEBUG ===
10:29:23.701 > 6_Final_Packet (60): 8102180018000408000000015B48AF9E 08D664DCE96BE754EF6DFA33DD892E4A ...
10:29:23.709 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:23.713 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:23.717 > Sending pipeline data to server (560 bytes)
10:29:23.927 > [HTTP] Response code: 400
10:29:23.927 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:23.932 > [HTTP] Request failed with code: 400
10:29:23.934 > [RETRY] Send failed, waiting 100 ms before retry
10:29:24.030 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:24.031 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:24.036 > Sending pipeline data to server (560 bytes)
10:29:24.177 > [HTTP] Response code: 400
10:29:24.177 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:24.183 > [HTTP] Request failed with code: 400
10:29:24.185 > [RETRY] Send failed, waiting 200 ms before retry
10:29:24.381 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:24.381 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:24.386 > Sending pipeline data to server (560 bytes)
10:29:24.707 > [HTTP] Response code: 400
10:29:24.707 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:24.713 > [HTTP] Request failed with code: 400
10:29:24.715 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:24.721 > [RETRY] Consecutive failures: 5
10:29:24.724 > [EMERGENCY] Triggering emergency reset!
10:29:24.726 > [CRYPTO] Resetting cryptographic state
10:29:24.733 > [CRYPTO] Crypto state reset complete
10:29:24.735 > [CRYPTO] Packet counter: 6
10:29:24.738 > [EMERGENCY] Emergency reset complete
10:29:24.740 > Health data send failed (retry count: 2/3)
10:29:24.844 > [308.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:24.852 > Generated health data: HR-65 SPO2-96 STEPS-1581
10:29:24.855 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:24.861 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:24.866 > Generated health data: HR-65 SPO2-96 STEPS-1548
10:29:24.869 > [ESP32] MsgKeys: lfsrSeed=0xBA070CDD tnk[0..3]=92506E0B trn[0..3]=E2BDB0B3
10:29:24.874 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313534384D50
10:29:24.882 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313534384D50000000000000 
10:29:24.891 > [ESP32][LFSR] Initializing - Seed: 0xBA070CDD SeedBe: 0xDD0C07BA ChaosKey[0..3]: 92506E0B InitialTap: 0x0029 State: 0xBA070CDD
10:29:24.899 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:29:24.907 > 3_After_LFSR (32): 955E2A8C95D4C1EFA1A352ED0C5D400F 4FD86644F56DAC828BDCACD9BC10A55E
10:29:24.915 > [ESP32][LFSR] Keystream (first 16 bytes): DD0C07BAA0F492BFEE917FD43A7D135B
10:29:24.921 > [ESP32][TINKERBELL] Input (first 16 bytes): 955E2A8C95D4C1EFA1A352ED0C5D400F Nonce: 0x00000001 Buffer size: 32 bytes
10:29:24.932 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 92506E0B
10:29:24.943 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:24.952 > 4_After_Tinkerbell (32): 08D66BE99EAFDC64EF6D89DD54E733FA 2498485B4A2EEDFF0C7709C159803DCF
10:29:24.960 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:24.965 > 5_After_Transposition (32): 5B48AF9E08D664DCE96BE754EF6DFA33 DD892E4A2498FFED09C1770C59803DCF      
10:29:24.974 > [ESP32] === HMAC DEBUG INFO ===
10:29:24.977 > [ESP32] HMAC Key being used: 4E7C22CE433F9AEB284F739C24D45A121356CCE254FF6595F8F4BDCA3DCC0AB9
10:29:24.985 > [ESP32] HMAC Input length: 44 bytes
10:29:24.988 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000015B48AF9E08D664DCE96BE754EF6DFA33DD892E4A
10:29:24.999 > [ESP32] Nonce: 0x00000001
10:29:24.999 > [ESP32] Packet size before HMAC: 60
10:29:25.004 > [ESP32] Computed HMAC Tag: A9F266EB29EFB53F4300B34E8C4519B3
10:29:25.010 > [ESP32] === END HMAC DEBUG ===
10:29:25.010 > 6_Final_Packet (60): 8102180018000408000000015B48AF9E 08D664DCE96BE754EF6DFA33DD892E4A ...
10:29:25.018 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:25.021 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:25.027 > Sending pipeline data to server (560 bytes)
10:29:25.181 > [HTTP] Response code: 400
10:29:25.181 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:25.186 > [HTTP] Request failed with code: 400
10:29:25.188 > [RETRY] Send failed, waiting 100 ms before retry
10:29:25.285 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:25.285 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:25.291 > Sending pipeline data to server (560 bytes)
10:29:25.442 > [HTTP] Response code: 400
10:29:25.442 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:25.447 > [HTTP] Request failed with code: 400
10:29:25.450 > [RETRY] Send failed, waiting 200 ms before retry
10:29:25.647 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:25.647 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:25.652 > Sending pipeline data to server (560 bytes)
10:29:25.991 > [HTTP] Response code: 400
10:29:25.991 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:25.996 > [HTTP] Request failed with code: 400
10:29:25.999 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:26.004 > [RETRY] Consecutive failures: 1
10:29:26.006 > Health data send failed (retry count: 3/3)
10:29:26.010 > Health data transmission failed after max retries
10:29:26.108 > [310.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:26.113 > ERROR state - attempting recovery
10:29:26.116 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:26.121 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:26.127 > Generated health data: HR-65 SPO2-96 STEPS-1573
10:29:26.130 > [ESP32] MsgKeys: lfsrSeed=0xBA070CDD tnk[0..3]=92506E0B trn[0..3]=E2BDB0B3
10:29:26.138 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313537334D50
10:29:26.143 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313537334D50000000000000 
10:29:26.152 > [ESP32][LFSR] Initializing - Seed: 0xBA070CDD SeedBe: 0xDD0C07BA ChaosKey[0..3]: 92506E0B InitialTap: 0x0029 State: 0xBA070CDD
10:29:26.164 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:29:26.171 > 3_After_LFSR (32): 955E2A8C95D4C1EFA1A352ED0C5D400F 4FD86644F56DAF898BDCACD9BC10A55E
10:29:26.177 > [ESP32][LFSR] Keystream (first 16 bytes): DD0C07BAA0F492BFEE917FD43A7D135B
10:29:26.185 > [ESP32][TINKERBELL] Input (first 16 bytes): 955E2A8C95D4C1EFA1A352ED0C5D400F Nonce: 0x00000001 Buffer size: 32 bytes
10:29:26.194 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 92506E0B
10:29:26.205 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:26.214 > 4_After_Tinkerbell (32): 08D66BE99EAFDC64EF6D89DD54E733FA 2498485B4A2EEEF40C7709C159803DCF
10:29:26.222 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D8841650B7B1D8B4ECEDB3058BA73F5
10:29:26.230 > 5_After_Transposition (32): 5B48AF9E08D664DCE96BE754EF6DFA33 DD892E4A2498F4EE09C1770C59803DCF      
10:29:26.238 > [ESP32] === HMAC DEBUG INFO ===
10:29:26.241 > [ESP32] HMAC Key being used: 4E7C22CE433F9AEB284F739C24D45A121356CCE254FF6595F8F4BDCA3DCC0AB9
10:29:26.249 > [ESP32] HMAC Input length: 44 bytes
10:29:26.252 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000015B48AF9E08D664DCE96BE754EF6DFA33DD892E4A
10:29:26.261 > [ESP32] Nonce: 0x00000001
10:29:26.263 > [ESP32] Packet size before HMAC: 60
10:29:26.266 > [ESP32] Computed HMAC Tag: 9B72AEAC062CB592918DB774346D57DF
10:29:26.271 > [ESP32] === END HMAC DEBUG ===
10:29:26.274 > 6_Final_Packet (60): 8102180018000408000000015B48AF9E 08D664DCE96BE754EF6DFA33DD892E4A ...
10:29:26.283 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:26.285 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:26.291 > Sending pipeline data to server (560 bytes)
10:29:26.718 > [HTTP] Response code: 400
10:29:26.719 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:26.724 > [HTTP] Request failed with code: 400
10:29:26.727 > [RETRY] Send failed, waiting 100 ms before retry
10:29:26.822 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:26.823 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:26.829 > Sending pipeline data to server (560 bytes)
10:29:27.191 > [HTTP] Response code: 400
10:29:27.191 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:27.197 > [HTTP] Request failed with code: 400
10:29:27.198 > [RETRY] Send failed, waiting 200 ms before retry
10:29:27.394 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:27.394 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:27.400 > Sending pipeline data to server (560 bytes)
10:29:27.722 > [HTTP] Response code: 400
10:29:27.722 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:27.727 > [HTTP] Request failed with code: 400
10:29:27.730 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:27.735 > [RETRY] Consecutive failures: 2
10:29:27.738 > ✗ Auto-recovery failed - restarting key exchange
10:29:34.841 > [318.8] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:34.849 > ✓ Public key loaded from NVS
10:29:34.945 > [WebSocket] Disconnected!
10:29:34.949 > [318.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.046 > [319.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.054 > Generating fresh master key from entropy...
10:29:35.061 > Generated master key (32): 8BA864C09AA2046C4D635BC97AD4F795 37CC4E45DFC1E83A08FCDCA1D0DA5E43 
10:29:35.067 > Using reduced master key (byte % 3) for NTRU encryption only
10:29:35.077 > NTRU encrypted master key (502): 00780006000700710069000000600065 00380006007E00180011001A000A0008 ...
10:29:35.086 > POST http://192.168.137.64:8081/master-key
10:29:35.226 > ✓ Master key exchange completed
10:29:35.328 > [319.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.336 > Loading master key from NVS and deriving symmetric keys...
10:29:35.339 > Loaded master key from NVS (32): 8BA864C09AA2046C4D635BC97AD4F795 37CC4E45DFC1E83A08FCDCA1D0DA5E43 
10:29:35.350 > Derived HMAC key (32): 66DBA5DFDEC347938A78C55F7E79BFE6 1F7C805231AF31EBDCDA354E6D9EC117 
10:29:35.355 > Derived Tinkerbell key (16): 06D6E757A45C9B5CE9AF7F9C60DA3A2D
10:29:35.361 > Derived Transposition key (16): DAE56AC8520209FEF775CF86DCD14048
10:29:35.370 > ✓ Symmetric keys derived successfully
10:29:35.372 > Nonce tracker reset - new session started
10:29:35.375 > ✓ Symmetric keys ready - starting health data transmission
10:29:35.480 > [319.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.581 > [319.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.681 > [319.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.781 > [319.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.881 > [319.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:35.981 > [320.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.082 > [320.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.181 > [320.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.281 > [320.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.380 > [320.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.481 > [320.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.581 > [320.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.681 > [320.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.780 > [320.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.880 > [320.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:36.981 > [321.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.080 > [321.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.181 > [321.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.281 > [321.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.381 > [321.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.480 > [321.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.581 > [321.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.681 > [321.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.782 > [321.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.881 > [321.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:37.980 > [322.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.081 > [322.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.181 > [322.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.280 > [322.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.381 > [322.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.480 > [322.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.581 > [322.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.681 > [322.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.780 > [322.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.881 > [322.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:38.981 > [323.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.081 > [323.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.181 > [323.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.281 > [323.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.381 > [323.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.481 > [323.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.581 > [323.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.681 > [323.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.781 > [323.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:39.880 > [323.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:44.987 > [329.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:45.088 > [WebSocket] Disconnected!
10:29:45.088 > [329.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED   
10:29:45.189 > [329.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:45.289 > [329.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:45.388 > [329.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:45.397 > Generated health data: HR-65 SPO2-96 STEPS-1658
10:29:45.400 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:45.405 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:45.411 > Generated health data: HR-65 SPO2-96 STEPS-1693
10:29:45.414 > [ESP32] MsgKeys: lfsrSeed=0xDBBA29CD tnk[0..3]=168E13CB trn[0..3]=3AB8FCDF
10:29:45.419 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313639334D50
10:29:45.427 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313639334D50000000000000
10:29:45.436 > [ESP32][LFSR] Initializing - Seed: 0xDBBA29CD SeedBe: 0xCD29BADB ChaosKey[0..3]: 168E13CB InitialTap: 0x0029 State: 0xDBBA29CD
10:29:45.444 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:29:45.452 > 3_After_LFSR (32): 857B97EDD3B25E044079D8BD358F7445 84606B5CACC609E07BC932258FEEA925
10:29:45.461 > [ESP32][LFSR] Keystream (first 16 bytes): CD29BADBE6920D540F4BF58403AF2711
10:29:45.466 > [ESP32][TINKERBELL] Input (first 16 bytes): 857B97EDD3B25E044079D8BD358F7445 Nonce: 0x00000001 Buffer size: 32 bytes
10:29:45.477 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 168E13CB
10:29:45.489 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:45.497 > 4_After_Tinkerbell (32): FE3FA46E9FEF9CEB215E64D7B8D570EF 87986EB8D3CFCA4BC68BCE09DF49883B 
10:29:45.505 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:45.510 > 5_After_Transposition (32): 9FFEB89CA4CF5EEBB821D7CA64EF3FEF D3876E706ED5984B88CE8B49DF3B09C6 
10:29:45.519 > [ESP32] === HMAC DEBUG INFO ===
10:29:45.521 > [ESP32] HMAC Key being used: 66DBA5DFDEC347938A78C55F7E79BFE61F7C805231AF31EBDCDA354E6D9EC117
10:29:45.530 > [ESP32] HMAC Input length: 44 bytes
10:29:45.532 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000019FFEB89CA4CF5EEBB821D7CA64EF3FEFD3876E70
10:29:45.544 > [ESP32] Nonce: 0x00000001
10:29:45.544 > [ESP32] Packet size before HMAC: 60
10:29:45.549 > [ESP32] Computed HMAC Tag: CD8F75AB6E3AEA748031F2C1636D2B37
10:29:45.555 > [ESP32] === END HMAC DEBUG ===
10:29:45.555 > 6_Final_Packet (60): 8102180018000408000000019FFEB89C A4CF5EEBB821D7CA64EF3FEFD3876E70 ...
10:29:45.563 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:45.566 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:45.572 > Sending pipeline data to server (560 bytes)
10:29:45.911 > [HTTP] Response code: 400
10:29:45.911 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:45.916 > [HTTP] Request failed with code: 400
10:29:45.920 > [RETRY] Send failed, waiting 100 ms before retry
10:29:46.015 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:46.015 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:46.021 > Sending pipeline data to server (560 bytes)
10:29:46.221 > [HTTP] Response code: 400
10:29:46.221 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:46.227 > [HTTP] Request failed with code: 400
10:29:46.229 > [RETRY] Send failed, waiting 200 ms before retry
10:29:46.426 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:46.426 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:46.431 > Sending pipeline data to server (560 bytes)
10:29:46.711 > [HTTP] Response code: 400
10:29:46.711 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:46.717 > [HTTP] Request failed with code: 400
10:29:46.719 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:46.725 > [RETRY] Consecutive failures: 3
10:29:46.728 > Health data send failed (retry count: 1/3)
10:29:46.826 > [330.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:46.835 > Generated health data: HR-65 SPO2-96 STEPS-1671
10:29:46.837 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:46.843 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:46.848 > Generated health data: HR-67 SPO2-96 STEPS-1651
10:29:46.851 > [ESP32] MsgKeys: lfsrSeed=0xDBBA29CD tnk[0..3]=168E13CB trn[0..3]=3AB8FCDF
10:29:46.857 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D313635314D50
10:29:46.865 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D313635314D50000000000000 
10:29:46.873 > [ESP32][LFSR] Initializing - Seed: 0xDBBA29CD SeedBe: 0xCD29BADB ChaosKey[0..3]: 168E13CB InitialTap: 0x0029 State: 0xDBBA29CD
10:29:46.882 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
10:29:46.890 > 3_After_LFSR (32): 857B97EDD1B25E044079D8BD358F7445 84606B5CACC605E27BC932258FEEA925
10:29:46.898 > [ESP32][LFSR] Keystream (first 16 bytes): CD29BADBE6920D540F4BF58403AF2711
10:29:46.904 > [ESP32][TINKERBELL] Input (first 16 bytes): 857B97EDD1B25E044079D8BD358F7445 Nonce: 0x00000001 Buffer size: 32 bytes
10:29:46.915 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 168E13CB
10:29:46.926 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:46.934 > 4_After_Tinkerbell (32): FE3FA46E9DEF9CEB215E64D7B8D570EF 87986EB8D3CFC649C68BCE09DF49883B
10:29:46.943 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:46.948 > 5_After_Transposition (32): 9DFEB89CA4CF5EEBB821D7C664EF3FEF D3876E706ED5984988CE8B49DF3B09C6      
10:29:46.957 > [ESP32] === HMAC DEBUG INFO ===
10:29:46.959 > [ESP32] HMAC Key being used: 66DBA5DFDEC347938A78C55F7E79BFE61F7C805231AF31EBDCDA354E6D9EC117
10:29:46.968 > [ESP32] HMAC Input length: 44 bytes
10:29:46.971 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000019DFEB89CA4CF5EEBB821D7C664EF3FEFD3876E70
10:29:46.982 > [ESP32] Nonce: 0x00000001
10:29:46.982 > [ESP32] Packet size before HMAC: 60
10:29:46.987 > [ESP32] Computed HMAC Tag: 627F5935C4A23EBDBBA3A684AB88D07C
10:29:46.993 > [ESP32] === END HMAC DEBUG ===
10:29:46.993 > 6_Final_Packet (60): 8102180018000408000000019DFEB89C A4CF5EEBB821D7C664EF3FEFD3876E70 ...
10:29:47.001 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:47.004 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:47.009 > Sending pipeline data to server (560 bytes)
10:29:47.204 > [HTTP] Response code: 400
10:29:47.204 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:47.209 > [HTTP] Request failed with code: 400
10:29:47.212 > [RETRY] Send failed, waiting 100 ms before retry
10:29:47.307 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:47.307 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:47.313 > Sending pipeline data to server (560 bytes)
10:29:47.456 > [HTTP] Response code: 400
10:29:47.456 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:47.461 > [HTTP] Request failed with code: 400
10:29:47.464 > [RETRY] Send failed, waiting 200 ms before retry
10:29:47.660 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:47.660 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:47.665 > Sending pipeline data to server (560 bytes)
10:29:47.986 > [HTTP] Response code: 400
10:29:47.987 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:47.993 > [HTTP] Request failed with code: 400
10:29:47.995 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:48.000 > [RETRY] Consecutive failures: 4
10:29:48.003 > Health data send failed (retry count: 2/3)
10:29:48.102 > [332.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:48.111 > Generated health data: HR-65 SPO2-96 STEPS-1698
10:29:48.113 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:48.119 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:48.124 > Generated health data: HR-65 SPO2-96 STEPS-1705
10:29:48.126 > [ESP32] MsgKeys: lfsrSeed=0xDBBA29CD tnk[0..3]=168E13CB trn[0..3]=3AB8FCDF
10:29:48.132 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313730354D50
10:29:48.141 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313730354D50000000000000 
10:29:48.148 > [ESP32][LFSR] Initializing - Seed: 0xDBBA29CD SeedBe: 0xCD29BADB ChaosKey[0..3]: 168E13CB InitialTap: 0x0029 State: 0xDBBA29CD
10:29:48.157 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:29:48.166 > 3_After_LFSR (32): 857B97EDD3B25E044079D8BD358F7445 84606B5CACC700E67BC932258FEEA925 
10:29:48.174 > [ESP32][LFSR] Keystream (first 16 bytes): CD29BADBE6920D540F4BF58403AF2711
10:29:48.179 > [ESP32][TINKERBELL] Input (first 16 bytes): 857B97EDD3B25E044079D8BD358F7445 Nonce: 0x00000001 Buffer size: 32 bytes
10:29:48.191 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 168E13CB
10:29:48.202 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:48.210 > 4_After_Tinkerbell (32): FE3FA46E9FEF9CEB215E64D7B8D570EF 87986EB8D3CEC34DC68BCE09DF49883B
10:29:48.219 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:48.224 > 5_After_Transposition (32): 9FFEB89CA4CE5EEBB821D7C364EF3FEF D3876E706ED5984D88CE8B49DF3B09C6      
10:29:48.233 > [ESP32] === HMAC DEBUG INFO ===
10:29:48.235 > [ESP32] HMAC Key being used: 66DBA5DFDEC347938A78C55F7E79BFE61F7C805231AF31EBDCDA354E6D9EC117
10:29:48.243 > [ESP32] HMAC Input length: 44 bytes
10:29:48.246 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000019FFEB89CA4CE5EEBB821D7C364EF3FEFD3876E70
10:29:48.257 > [ESP32] Nonce: 0x00000001
10:29:48.257 > [ESP32] Packet size before HMAC: 60
10:29:48.263 > [ESP32] Computed HMAC Tag: 4178CAB2E2C3FFC753529B22EC1E39CE
10:29:48.268 > [ESP32] === END HMAC DEBUG ===
10:29:48.268 > 6_Final_Packet (60): 8102180018000408000000019FFEB89C A4CE5EEBB821D7C364EF3FEFD3876E70 ...
10:29:48.277 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:48.280 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:48.285 > Sending pipeline data to server (560 bytes)
10:29:48.465 > [HTTP] Response code: 400
10:29:48.465 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:48.470 > [HTTP] Request failed with code: 400
10:29:48.473 > [RETRY] Send failed, waiting 100 ms before retry
10:29:48.570 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:48.570 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:48.575 > Sending pipeline data to server (560 bytes)
10:29:48.708 > [HTTP] Response code: 400
10:29:48.708 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:48.714 > [HTTP] Request failed with code: 400
10:29:48.716 > [RETRY] Send failed, waiting 200 ms before retry
10:29:48.912 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:48.912 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:48.917 > Sending pipeline data to server (560 bytes)
10:29:49.224 > [HTTP] Response code: 400
10:29:49.224 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:49.230 > [HTTP] Request failed with code: 400
10:29:49.232 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:49.238 > [RETRY] Consecutive failures: 5
10:29:49.241 > [EMERGENCY] Triggering emergency reset!
10:29:49.244 > [CRYPTO] Resetting cryptographic state
10:29:49.249 > [CRYPTO] Crypto state reset complete
10:29:49.252 > [CRYPTO] Packet counter: 7
10:29:49.256 > [EMERGENCY] Emergency reset complete
10:29:49.258 > Health data send failed (retry count: 3/3)
10:29:49.261 > Health data transmission failed after max retries
10:29:49.361 > [333.3] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:49.367 > ERROR state - attempting recovery
10:29:49.369 > [RETRY] Attempting to send health data (Max retries: 3)
10:29:49.375 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:29:49.380 > Generated health data: HR-65 SPO2-96 STEPS-1712
10:29:49.383 > [ESP32] MsgKeys: lfsrSeed=0xDBBA29CD tnk[0..3]=168E13CB trn[0..3]=3AB8FCDF
10:29:49.391 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313731324D50
10:29:49.397 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313731324D50000000000000 
10:29:49.405 > [ESP32][LFSR] Initializing - Seed: 0xDBBA29CD SeedBe: 0xCD29BADB ChaosKey[0..3]: 168E13CB InitialTap: 0x0029 State: 0xDBBA29CD
10:29:49.416 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes       
10:29:49.425 > 3_After_LFSR (32): 857B97EDD3B25E044079D8BD358F7445 84606B5CACC701E17BC932258FEEA925
10:29:49.430 > [ESP32][LFSR] Keystream (first 16 bytes): CD29BADBE6920D540F4BF58403AF2711
10:29:49.438 > [ESP32][TINKERBELL] Input (first 16 bytes): 857B97EDD3B25E044079D8BD358F7445 Nonce: 0x00000001 Buffer size: 32 bytes
10:29:49.447 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 168E13CB
10:29:49.458 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:49.466 > 4_After_Tinkerbell (32): FE3FA46E9FEF9CEB215E64D7B8D570EF 87986EB8D3CEC24AC68BCE09DF49883B
10:29:49.475 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7B4433834C5DC2EF6127BC6A8D5A04AA
10:29:49.483 > 5_After_Transposition (32): 9FFEB89CA4CE5EEBB821D7C264EF3FEF D3876E706ED5984A88CE8B49DF3B09C6      
10:29:49.492 > [ESP32] === HMAC DEBUG INFO ===
10:29:49.494 > [ESP32] HMAC Key being used: 66DBA5DFDEC347938A78C55F7E79BFE61F7C805231AF31EBDCDA354E6D9EC117      
10:29:49.503 > [ESP32] HMAC Input length: 44 bytes
10:29:49.506 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000019FFEB89CA4CE5EEBB821D7C264EF3FEFD3876E70
10:29:49.514 > [ESP32] Nonce: 0x00000001
10:29:49.516 > [ESP32] Packet size before HMAC: 60
10:29:49.519 > [ESP32] Computed HMAC Tag: 35B494195ACF7EA39698D19FFD44C0DD
10:29:49.525 > [ESP32] === END HMAC DEBUG ===
10:29:49.527 > 6_Final_Packet (60): 8102180018000408000000019FFEB89C A4CE5EEBB821D7C264EF3FEFD3876E70 ...
10:29:49.536 > [RETRY] Attempt 1/3 (nonce: 1)
10:29:49.538 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:49.544 > Sending pipeline data to server (560 bytes)
10:29:49.711 > [HTTP] Response code: 400
10:29:49.712 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:49.717 > [HTTP] Request failed with code: 400
10:29:49.719 > [RETRY] Send failed, waiting 100 ms before retry
10:29:49.815 > [RETRY] Attempt 2/3 (nonce: 1)
10:29:49.815 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:49.821 > Sending pipeline data to server (560 bytes)
10:29:50.265 > [HTTP] Response code: 400
10:29:50.265 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:50.270 > [HTTP] Request failed with code: 400
10:29:50.273 > [RETRY] Send failed, waiting 200 ms before retry
10:29:50.469 > [RETRY] Attempt 3/3 (nonce: 1)
10:29:50.469 > POST http://192.168.137.64:8081/health-data with pipeline data
10:29:50.475 > Sending pipeline data to server (560 bytes)
10:29:50.718 > [HTTP] Response code: 400
10:29:50.718 > [HTTP] Error response: {"error":"Decryption failed"}
10:29:50.724 > [HTTP] Request failed with code: 400
10:29:50.726 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:29:50.732 > [RETRY] Consecutive failures: 1
10:29:50.735 > ✗ Auto-recovery failed - restarting key exchange
10:29:57.839 > [341.8] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:57.847 > ✓ Public key loaded from NVS
10:29:57.944 > [WebSocket] Disconnected!
10:29:57.944 > [341.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.044 > [342.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.053 > Generating fresh master key from entropy...
10:29:58.059 > Generated master key (32): 586EDD6074134827D467785F8B73FA96 F8BCDD6F83CE6576FFA40B2F9C8CE05A       
10:29:58.065 > Using reduced master key (byte % 3) for NTRU encryption only
10:29:58.076 > NTRU encrypted master key (502): 0078000800080071006A0001005F0065 00380007007D001A00100019000A0006 ...
10:29:58.084 > POST http://192.168.137.64:8081/master-key
10:29:58.220 > ✓ Master key exchange completed
10:29:58.322 > [342.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.330 > Loading master key from NVS and deriving symmetric keys...
10:29:58.333 > Loaded master key from NVS (32): 586EDD6074134827D467785F8B73FA96 F8BCDD6F83CE6576FFA40B2F9C8CE05A 
10:29:58.344 > Derived HMAC key (32): 7C0193E596C10AB4B417A4F58D913EB7 0597259F10B9540703A4359E12397AC9 
10:29:58.350 > Derived Tinkerbell key (16): 37B2CFC637F49F884EAD79E4830C9EAE
10:29:58.355 > Derived Transposition key (16): 0B9F349060A91FF374747D7CFB4ED12A 
10:29:58.364 > ✓ Symmetric keys derived successfully
10:29:58.366 > Nonce tracker reset - new session started
10:29:58.369 > ✓ Symmetric keys ready - starting health data transmission
10:29:58.475 > [342.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.575 > [342.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.675 > [342.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.776 > [342.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.876 > [342.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:58.976 > [343.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.076 > [343.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.175 > [343.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.275 > [343.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.375 > [343.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.476 > [343.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.575 > [343.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.675 > [343.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.775 > [343.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.876 > [343.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:29:59.975 > [344.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.075 > [344.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.175 > [344.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.275 > [344.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.375 > [344.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.474 > [344.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.576 > [344.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.676 > [344.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.775 > [344.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.875 > [344.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:00.975 > [345.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.075 > [345.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.175 > [345.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.275 > [345.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.376 > [345.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.475 > [345.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.576 > [345.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.676 > [345.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.775 > [345.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.876 > [345.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:01.975 > [346.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.075 > [346.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.175 > [346.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.275 > [346.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.375 > [346.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.475 > [346.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.575 > [346.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.676 > [346.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.775 > [346.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:02.875 > [346.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:07.980 > [352.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:08.080 > [WebSocket] Disconnected!
10:30:08.081 > [352.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED   
10:30:08.182 > [352.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:08.282 > [352.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:08.381 > [352.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
10:30:08.390 > Generated health data: HR-65 SPO2-96 STEPS-1801
10:30:08.392 > [RETRY] Attempting to send health data (Max retries: 3)
10:30:08.398 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:30:08.404 > Generated health data: HR-65 SPO2-96 STEPS-1765
10:30:08.407 > [ESP32] MsgKeys: lfsrSeed=0x1AC499BF tnk[0..3]=2988FA58 trn[0..3]=EA8B8108
10:30:08.412 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313736354D50
10:30:08.421 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313736354D50000000000000
10:30:08.429 > [ESP32][LFSR] Initializing - Seed: 0x1AC499BF SeedBe: 0xBF99C41A ChaosKey[0..3]: 2988FA58 InitialTap: 0x0029 State: 0x1AC499BF
10:30:08.438 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
10:30:08.446 > 3_After_LFSR (32): F7CBE92C70B057A3860B39BA9F5DCB60 CAE812E0006F941E26D83ADEA479203E
10:30:08.454 > [ESP32][LFSR] Keystream (first 16 bytes): BF99C41A459004F3C9391483A97D9834
10:30:08.460 > [ESP32][TINKERBELL] Input (first 16 bytes): F7CBE92C70B057A3860B39BA9F5DCB60 Nonce: 0x00000001 Buffer size: 32 bytes
10:30:08.471 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 2988FA58
10:30:08.481 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B7ACCCA690B0272FC9465D255B69A57A
10:30:08.490 > 4_After_Tinkerbell (32): 4067258AE000708C4F4D649FC4346E1A 89B2719D3AA9B784FF7F1A2CD218ED86
10:30:08.498 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B7ACCCA690B0272FC9465D255B69A57A
10:30:08.504 > 5_After_Transposition (32): 8C7000E04F4D649F1A6E34C489B2719D 84B7A93A4067258AD218ED86FF7F1A2C 
10:30:08.512 > [ESP32] === HMAC DEBUG INFO ===
10:30:08.515 > [ESP32] HMAC Key being used: 7C0193E596C10AB4B417A4F58D913EB70597259F10B9540703A4359E12397AC9
10:30:08.524 > [ESP32] HMAC Input length: 44 bytes
10:30:08.526 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000018C7000E04F4D649F1A6E34C489B2719D84B7A93A
10:30:08.538 > [ESP32] Nonce: 0x00000001
10:30:08.538 > [ESP32] Packet size before HMAC: 60
10:30:08.543 > [ESP32] Computed HMAC Tag: 2C470B50988E4A17208F659931290098
10:30:08.548 > [ESP32] === END HMAC DEBUG ===
10:30:08.549 > 6_Final_Packet (60): 8102180018000408000000018C7000E0 4F4D649F1A6E34C489B2719D84B7A93A ...
10:30:08.556 > [RETRY] Attempt 1/3 (nonce: 1)
10:30:08.559 > POST http://192.168.137.64:8081/health-data with pipeline data
10:30:08.565 > Sending pipeline data to server (560 bytes)
10:30:08.721 > [HTTP] Response code: 200
10:30:08.721 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:30:08.727 > [RETRY] Health data sent successfully!
10:30:08.729 > ✓ Health data #7 sent successfully
10:30:08.825 > [352.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:08.926 > [352.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.026 > [353.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.126 > [353.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.226 > [353.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.326 > [353.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.426 > [353.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.526 > [353.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.626 > [353.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.726 > [353.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.826 > [353.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:09.926 > [353.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.026 > [354.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.126 > [354.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.227 > [354.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.327 > [354.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.426 > [354.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.527 > [354.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.627 > [354.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.727 > [354.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.827 > [354.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:10.927 > [354.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.027 > [355.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.127 > [355.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.227 > [355.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.326 > [355.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.427 > [355.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.527 > [355.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.627 > [355.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.727 > [355.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.827 > [355.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:11.926 > [355.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.027 > [356.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.126 > [356.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.226 > [356.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.327 > [356.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.427 > [356.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.527 > [356.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.627 > [356.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.727 > [356.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.827 > [356.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:12.926 > [356.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:13.027 > [357.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.132 > [362.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.231 > [WebSocket] Disconnected!
10:30:18.232 > [362.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED   
10:30:18.333 > [362.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.433 > [362.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.533 > [362.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.633 > [362.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.733 > [362.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
10:30:18.741 > Generated health data: HR-66 SPO2-96 STEPS-1836
10:30:18.744 > [RETRY] Attempting to send health data (Max retries: 3)
10:30:18.749 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:30:18.755 > Generated health data: HR-66 SPO2-96 STEPS-1812
10:30:18.758 > [ESP32] MsgKeys: lfsrSeed=0xC4E60722 tnk[0..3]=1FBF6742 trn[0..3]=D2335771
10:30:18.763 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313831324D50
10:30:18.771 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313831324D50000000000000
10:30:18.780 > [ESP32][LFSR] Initializing - Seed: 0xC4E60722 SeedBe: 0x2207E6C4 ChaosKey[0..3]: 1FBF6742 InitialTap: 0x0029 State: 0xC4E60722
10:30:18.788 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
10:30:18.796 > 3_After_LFSR (32): 6A55CBF2DD4DAE10E3A2D3DF8ED7AF74 4F138591336C71DBE50FC714B65C06E1
10:30:18.805 > [ESP32][LFSR] Keystream (first 16 bytes): 2207E6C4EB6DFD40AC90FEE6B8F7FC20
10:30:18.810 > [ESP32][TINKERBELL] Input (first 16 bytes): 6A55CBF2DD4DAE10E3A2D3DF8ED7AF74 Nonce: 0x00000002 Buffer size: 32 bytes
10:30:18.821 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 1FBF6742
10:30:18.832 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BE8FC1B2A71F7B3FE2A5F64C21203D23
10:30:18.841 > 4_After_Tinkerbell (32): D4DA0A407A52D52F01072593AFF79257 0392BB074B34949436B7E9ACB05B6151
10:30:18.849 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BE8FC1B2A71F7B3FE2A5F64C21203D23
10:30:18.855 > 5_After_Transposition (32): 010725939434944B0392BB0757F792AF D4DA0A402F52D57A51615BB036B7E9AC 
10:30:18.863 > [ESP32] === HMAC DEBUG INFO ===
10:30:18.866 > [ESP32] HMAC Key being used: 7C0193E596C10AB4B417A4F58D913EB70597259F10B9540703A4359E12397AC9
10:30:18.874 > [ESP32] HMAC Input length: 44 bytes
10:30:18.877 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002010725939434944B0392BB0757F792AFD4DA0A40
10:30:18.888 > [ESP32] Nonce: 0x00000002
10:30:18.888 > [ESP32] Packet size before HMAC: 60
10:30:18.894 > [ESP32] Computed HMAC Tag: DCEC8EBC7794AD805373F37ECB572680
10:30:18.899 > [ESP32] === END HMAC DEBUG ===
10:30:18.899 > 6_Final_Packet (60): 81021800180004080000000201072593 9434944B0392BB0757F792AFD4DA0A40 ...
10:30:18.907 > [RETRY] Attempt 1/3 (nonce: 2)
10:30:18.910 > POST http://192.168.137.64:8081/health-data with pipeline data
10:30:18.916 > Sending pipeline data to server (560 bytes)
10:30:19.228 > [HTTP] Response code: 200
10:30:19.228 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:30:19.233 > [RETRY] Health data sent successfully!
10:30:19.235 > ✓ Health data #8 sent successfully
10:30:19.332 > [363.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.432 > [363.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.533 > [363.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.632 > [363.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.733 > [363.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.832 > [363.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:19.933 > [363.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.033 > [364.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.133 > [364.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.233 > [364.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.333 > [364.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.433 > [364.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.533 > [364.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.633 > [364.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.733 > [364.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.833 > [364.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:20.932 > [364.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.032 > [365.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.132 > [365.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.232 > [365.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.332 > [365.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.433 > [365.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.533 > [365.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.632 > [365.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.732 > [365.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.832 > [365.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:21.932 > [365.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.033 > [366.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.133 > [366.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.232 > [366.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.332 > [366.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.432 > [366.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.532 > [366.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.632 > [366.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.732 > [366.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.833 > [366.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:22.933 > [366.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:23.032 > [367.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:23.133 > [367.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.238 > [372.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.338 > [WebSocket] Disconnected!
10:30:28.338 > [372.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED   
10:30:28.440 > [372.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.539 > [372.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.639 > [372.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.740 > [372.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.840 > [372.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:28.939 > [372.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:29.039 > [373.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:29.140 > [373.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:29.239 > [373.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
10:30:29.247 > Generated health data: HR-66 SPO2-96 STEPS-1903
10:30:29.250 > [RETRY] Attempting to send health data (Max retries: 3)
10:30:29.255 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
10:30:29.262 > Generated health data: HR-66 SPO2-96 STEPS-1899
10:30:29.264 > [ESP32] MsgKeys: lfsrSeed=0x61DB8630 tnk[0..3]=8726BB06 trn[0..3]=ADBB9764
10:30:29.270 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313839394D50
10:30:29.278 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313839394D50000000000000
10:30:29.286 > [ESP32][LFSR] Initializing - Seed: 0x61DB8630 SeedBe: 0x3086DB61 ChaosKey[0..3]: 8726BB06 InitialTap: 0x0029 State: 0x61DB8630
10:30:29.295 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
10:30:29.303 > 3_After_LFSR (32): 78D4F657A9E0A2A6EE79D9B39BE50678 43E52BCFBF6B217FB5A136D325421CC6
10:30:29.311 > [ESP32][LFSR] Keystream (first 16 bytes): 3086DB619FC0F1F6A14BF48AADC5552C
10:30:29.317 > [ESP32][TINKERBELL] Input (first 16 bytes): 78D4F657A9E0A2A6EE79D9B39BE50678 Nonce: 0x00000003 Buffer size: 32 bytes
10:30:29.328 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 8726BB06
10:30:29.339 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 884FE15BFD3E9090AF8FA90F80890BB0
10:30:29.347 > 4_After_Tinkerbell (32): F09B170C54DE323641F670BC1B6C0DC8 5FA2AD4065BA4A90E1EE40585ED6B1AD 
10:30:29.356 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 884FE15BFD3E9090AF8FA90F80890BB0
10:30:29.361 > 5_After_Transposition (32): 5840EEE1C81B6C0D40ADA25F3654DE32 0C9B17F05ED6B1ADBCF6704165BA4A90 
10:30:29.370 > [ESP32] === HMAC DEBUG INFO ===
10:30:29.373 > [ESP32] HMAC Key being used: 7C0193E596C10AB4B417A4F58D913EB70597259F10B9540703A4359E12397AC9
10:30:29.381 > [ESP32] HMAC Input length: 44 bytes
10:30:29.384 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000035840EEE1C81B6C0D40ADA25F3654DE320C9B17F0
10:30:29.395 > [ESP32] Nonce: 0x00000003
10:30:29.395 > [ESP32] Packet size before HMAC: 60
10:30:29.401 > [ESP32] Computed HMAC Tag: 496464C77DA6EA4BFC518F92BEA2C354
10:30:29.406 > [ESP32] === END HMAC DEBUG ===
10:30:29.406 > 6_Final_Packet (60): 8102180018000408000000035840EEE1 C81B6C0D40ADA25F3654DE320C9B17F0 ...
10:30:29.414 > [RETRY] Attempt 1/3 (nonce: 3)
10:30:29.416 > POST http://192.168.137.64:8081/health-data with pipeline data
10:30:29.422 > Sending pipeline data to server (560 bytes)
10:30:29.795 > [HTTP] Response code: 200
10:30:29.796 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:30:29.801 > [RETRY] Health data sent successfully!
10:30:29.803 > ✓ Health data #9 sent successfully
10:30:29.900 > [373.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.000 > [374.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.100 > [374.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.200 > [374.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.300 > [374.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.400 > [374.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.500 > [374.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.600 > [374.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.701 > [374.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.800 > [374.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:30.900 > [374.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.001 > [375.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.100 > [375.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.200 > [375.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.300 > [375.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.400 > [375.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.501 > [375.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.600 > [375.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.700 > [375.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.800 > [375.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:31.900 > [375.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.000 > [376.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.100 > [376.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.200 > [376.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.300 > [376.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.400 > [376.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.500 > [376.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.600 > [376.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.700 > [376.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.800 > [376.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:30:32.900 > [376.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
10:35:16.856 > [660.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: DISCONNECTED
10:35:16.956 > [660.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: DISCONNECTED
10:35:17.056 > [661.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: DISCONNECTED
10:35:17.155 > [661.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: DISCONNECTED
10:35:17.164 > Generated health data: HR-71 SPO2-97 STEPS-3352
10:35:17.166 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:17.172 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:35:17.177 > Generated health data: HR-71 SPO2-97 STEPS-3349
10:35:17.180 > [ESP32] MsgKeys: lfsrSeed=0xF1DBE33E tnk[0..3]=B2D6AEEB trn[0..3]=2717484F
10:35:17.186 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333334394D50
10:35:17.194 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333334394D50000000000000
10:35:17.203 > [ESP32][LFSR] Initializing - Seed: 0xF1DBE33E SeedBe: 0x3EE3DBF1 ChaosKey[0..3]: B2D6AEEB InitialTap: 0x0029 State: 0xF1DBE33E
10:35:17.213 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:35:17.219 > 3_After_LFSR (32): 76B1F6C6A752A620F08D4A42D0DB47E1 0026BAB6BA028EA6B1AECC73327D6D71 
10:35:17.227 > [ESP32][LFSR] Keystream (first 16 bytes): 3EE3DBF19672F570BFBF677BE7FB14B5
10:35:17.235 > [ESP32][TINKERBELL] Input (first 16 bytes): 76B1F6C6A752A620F08D4A42D0DB47E1 Nonce: 0x00000001 Buffer size: 32 bytes
10:35:17.244 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B2D6AEEB
10:35:17.255 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E45C30401812DFC367BBD3070BAB960C
10:35:17.264 > 4_After_Tinkerbell (32): 92EDC686BF4079E397369945DB70D1ED A16B01EA9D19199E09001A0C97B707E9 
10:35:17.272 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E45C30401812DFC367BBD3070BAB960C
10:35:17.277 > 5_After_Transposition (32): 9736994570D1EDDBA16B01EA19199E9D 92EDC686B707E99709001A0C4079E3BF 
10:35:17.286 > [ESP32] === HMAC DEBUG INFO ===
10:35:17.289 > [ESP32] HMAC Key being used: C3141639CD82C6685A834DF990B00E1F7558E43A679E470918604C8B26D9AD89      
10:35:17.296 > [ESP32] HMAC Input length: 44 bytes
10:35:17.299 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000019736994570D1EDDBA16B01EA19199E9D92EDC686
10:35:17.310 > [ESP32] Nonce: 0x00000001
10:35:17.313 > [ESP32] Packet size before HMAC: 60
10:35:17.317 > [ESP32] Computed HMAC Tag: C324DA4C71CBFF67879595BF5422846F
10:35:17.321 > [ESP32] === END HMAC DEBUG ===
10:35:17.324 > 6_Final_Packet (60): 81021800180004080000000197369945 70D1EDDBA16B01EA19199E9D92EDC686 ...
10:35:17.330 > [RETRY] Attempt 1/3 (nonce: 1)
10:35:17.332 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:17.338 > Sending pipeline data to server (560 bytes)
10:35:17.493 > [HTTP] Response code: 200
10:35:17.493 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:35:17.499 > [RETRY] Health data sent successfully!
10:35:17.501 > ✓ Health data #18 sent successfully
10:35:17.597 > [661.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:17.699 > [661.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:17.799 > [661.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:17.899 > [661.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:17.999 > [662.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.099 > [662.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.199 > [662.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.298 > [662.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.398 > [662.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.499 > [662.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.599 > [662.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.698 > [662.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.799 > [662.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.899 > [662.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:18.999 > [663.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.098 > [663.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.199 > [663.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.298 > [663.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.399 > [663.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.498 > [663.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.598 > [663.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.699 > [663.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.798 > [663.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.899 > [663.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:19.999 > [664.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.099 > [664.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.199 > [664.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.299 > [664.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.398 > [664.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.498 > [664.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.598 > [664.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.699 > [664.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.799 > [664.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.899 > [664.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:20.998 > [665.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.098 > [665.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.198 > [665.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.298 > [665.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.398 > [665.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.499 > [665.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:21.599 > [665.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:26.703 > [670.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:26.802 > [WebSocket] Disconnected!
10:35:26.803 > [670.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED  
10:35:26.903 > [670.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.003 > [671.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.103 > [671.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.204 > [671.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.305 > [671.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.404 > [671.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.505 > [671.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:27.512 > Generated health data: HR-71 SPO2-97 STEPS-3388
10:35:27.515 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:27.521 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:35:27.526 > Generated health data: HR-71 SPO2-97 STEPS-3403
10:35:27.529 > [ESP32] MsgKeys: lfsrSeed=0xE268B622 tnk[0..3]=CB8B9637 trn[0..3]=8FC58896
10:35:27.535 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333430334D50
10:35:27.543 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333430334D50000000000000
10:35:27.551 > [ESP32][LFSR] Initializing - Seed: 0xE268B622 SeedBe: 0x22B668E2 ChaosKey[0..3]: CB8B9637 InitialTap: 0x0029 State: 0xE268B622
10:35:27.562 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:35:27.568 > 3_After_LFSR (32): 6AE445D573002230178B019DBC929881 C999F986C18850DB48D8AE80FBF49AE1 
10:35:27.576 > [ESP32][LFSR] Keystream (first 16 bytes): 22B668E24220716058B92CA48BB2CBD5
10:35:27.584 > [ESP32][TINKERBELL] Input (first 16 bytes): 6AE445D573002230178B019DBC929881 Nonce: 0x00000002 Buffer size: 32 bytes
10:35:27.593 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CB8B9637
10:35:27.604 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:27.612 > 4_After_Tinkerbell (32): 0FC5316A85B57465CE4DA014CF071B79 7D7C5CAD111E3953252634A6CEAEBAA2
10:35:27.621 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:27.626 > 5_After_Transposition (32): CEAEA63465740FC5111EAD5C791BCE4D CF0714A053397D7C85B56A31A2BA2526      
10:35:27.635 > [ESP32] === HMAC DEBUG INFO ===
10:35:27.637 > [ESP32] HMAC Key being used: C3141639CD82C6685A834DF990B00E1F7558E43A679E470918604C8B26D9AD89
10:35:27.645 > [ESP32] HMAC Input length: 44 bytes
10:35:27.648 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002CEAEA63465740FC5111EAD5C791BCE4DCF0714A0
10:35:27.660 > [ESP32] Nonce: 0x00000002
10:35:27.662 > [ESP32] Packet size before HMAC: 60
10:35:27.665 > [ESP32] Computed HMAC Tag: 594C638E6C47140993B844738ACD243E
10:35:27.670 > [ESP32] === END HMAC DEBUG ===
10:35:27.673 > 6_Final_Packet (60): 810218001800040800000002CEAEA634 65740FC5111EAD5C791BCE4DCF0714A0 ...
10:35:27.679 > [RETRY] Attempt 1/3 (nonce: 2)
10:35:27.682 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:27.687 > Sending pipeline data to server (560 bytes)
10:35:27.993 > [HTTP] Response code: 400
10:35:27.998 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:28.002 > [HTTP] Request failed with code: 400
10:35:28.002 > [RETRY] Send failed, waiting 100 ms before retry
10:35:28.098 > [RETRY] Attempt 2/3 (nonce: 2)
10:35:28.098 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:28.103 > Sending pipeline data to server (560 bytes)
10:35:28.251 > [HTTP] Response code: 400
10:35:28.251 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:28.257 > [HTTP] Request failed with code: 400
10:35:28.259 > [RETRY] Send failed, waiting 200 ms before retry
10:35:28.455 > [RETRY] Attempt 3/3 (nonce: 2)
10:35:28.455 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:28.461 > Sending pipeline data to server (560 bytes)
10:35:28.779 > [HTTP] Response code: 400
10:35:28.779 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:28.785 > [HTTP] Request failed with code: 400
10:35:28.788 > [RETRY] All retry attempts failed - rolled back nonce to 1
10:35:28.793 > [RETRY] Consecutive failures: 1
10:35:28.796 > Health data send failed (retry count: 1/3)
10:35:28.895 > [672.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:28.904 > Generated health data: HR-71 SPO2-97 STEPS-3400
10:35:28.907 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:28.912 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:35:28.917 > Generated health data: HR-71 SPO2-97 STEPS-3405
10:35:28.920 > [ESP32] MsgKeys: lfsrSeed=0xE268B622 tnk[0..3]=CB8B9637 trn[0..3]=8FC58896
10:35:28.925 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333430354D50
10:35:28.934 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333430354D50000000000000 
10:35:28.943 > [ESP32][LFSR] Initializing - Seed: 0xE268B622 SeedBe: 0x22B668E2 ChaosKey[0..3]: CB8B9637 InitialTap: 0x0029 State: 0xE268B622
10:35:28.954 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:35:28.959 > 3_After_LFSR (32): 6AE445D573002230178B019DBC929881 C999F986C18850DD48D8AE80FBF49AE1 
10:35:28.968 > [ESP32][LFSR] Keystream (first 16 bytes): 22B668E24220716058B92CA48BB2CBD5
10:35:28.976 > [ESP32][TINKERBELL] Input (first 16 bytes): 6AE445D573002230178B019DBC929881 Nonce: 0x00000002 Buffer size: 32 bytes
10:35:28.985 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CB8B9637
10:35:28.996 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:29.004 > 4_After_Tinkerbell (32): 0FC5316A85B57465CE4DA014CF071B79 7D7C5CAD111E3955252634A6CEAEBAA2
10:35:29.012 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:29.017 > 5_After_Transposition (32): CEAEA63465740FC5111EAD5C791BCE4D CF0714A055397D7C85B56A31A2BA2526      
10:35:29.026 > [ESP32] === HMAC DEBUG INFO ===
10:35:29.029 > [ESP32] HMAC Key being used: C3141639CD82C6685A834DF990B00E1F7558E43A679E470918604C8B26D9AD89      
10:35:29.037 > [ESP32] HMAC Input length: 44 bytes
10:35:29.040 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002CEAEA63465740FC5111EAD5C791BCE4DCF0714A0
10:35:29.051 > [ESP32] Nonce: 0x00000002
10:35:29.054 > [ESP32] Packet size before HMAC: 60
10:35:29.057 > [ESP32] Computed HMAC Tag: DCE8B4EF0272604A3429B8F8F1590104
10:35:29.062 > [ESP32] === END HMAC DEBUG ===
10:35:29.064 > 6_Final_Packet (60): 810218001800040800000002CEAEA634 65740FC5111EAD5C791BCE4DCF0714A0 ...
10:35:29.070 > [RETRY] Attempt 1/3 (nonce: 2)
10:35:29.073 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:29.078 > Sending pipeline data to server (560 bytes)
10:35:29.495 > [HTTP] Response code: 400
10:35:29.495 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:29.501 > [HTTP] Request failed with code: 400
10:35:29.504 > [RETRY] Send failed, waiting 100 ms before retry
10:35:29.599 > [RETRY] Attempt 2/3 (nonce: 2)
10:35:29.599 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:29.605 > Sending pipeline data to server (560 bytes)
10:35:29.748 > [HTTP] Response code: 400
10:35:29.748 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:29.753 > [HTTP] Request failed with code: 400
10:35:29.756 > [RETRY] Send failed, waiting 200 ms before retry
10:35:29.952 > [RETRY] Attempt 3/3 (nonce: 2)
10:35:29.953 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:29.957 > Sending pipeline data to server (560 bytes)
10:35:30.252 > [HTTP] Response code: 400
10:35:30.252 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:30.257 > [HTTP] Request failed with code: 400
10:35:30.261 > [RETRY] All retry attempts failed - rolled back nonce to 1
10:35:30.266 > [RETRY] Consecutive failures: 2
10:35:30.268 > Health data send failed (retry count: 2/3)
10:35:30.368 > [674.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:30.376 > Generated health data: HR-71 SPO2-97 STEPS-3413
10:35:30.379 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:30.385 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:35:30.390 > Generated health data: HR-71 SPO2-97 STEPS-3399
10:35:30.393 > [ESP32] MsgKeys: lfsrSeed=0xE268B622 tnk[0..3]=CB8B9637 trn[0..3]=8FC58896
10:35:30.399 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333339394D50
10:35:30.407 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333339394D50000000000000 
10:35:30.416 > [ESP32][LFSR] Initializing - Seed: 0xE268B622 SeedBe: 0x22B668E2 ChaosKey[0..3]: CB8B9637 InitialTap: 0x0029 State: 0xE268B622
10:35:30.426 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
10:35:30.432 > 3_After_LFSR (32): 6AE445D573002230178B019DBC929881 C999F986C18F59D148D8AE80FBF49AE1
10:35:30.440 > [ESP32][LFSR] Keystream (first 16 bytes): 22B668E24220716058B92CA48BB2CBD5
10:35:30.449 > [ESP32][TINKERBELL] Input (first 16 bytes): 6AE445D573002230178B019DBC929881 Nonce: 0x00000002 Buffer size: 32 bytes
10:35:30.457 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CB8B9637
10:35:30.468 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:30.477 > 4_After_Tinkerbell (32): 0FC5316A85B57465CE4DA014CF071B79 7D7C5CAD11193059252634A6CEAEBAA2
10:35:30.485 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:30.490 > 5_After_Transposition (32): CEAEA63465740FC51119AD5C791BCE4D CF0714A059307D7C85B56A31A2BA2526 
10:35:30.499 > [ESP32] === HMAC DEBUG INFO ===
10:35:30.502 > [ESP32] HMAC Key being used: C3141639CD82C6685A834DF990B00E1F7558E43A679E470918604C8B26D9AD89
10:35:30.510 > [ESP32] HMAC Input length: 44 bytes
10:35:30.513 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002CEAEA63465740FC51119AD5C791BCE4DCF0714A0
10:35:30.524 > [ESP32] Nonce: 0x00000002
10:35:30.527 > [ESP32] Packet size before HMAC: 60
10:35:30.530 > [ESP32] Computed HMAC Tag: A8D28D5D528F9EB46FF7E3FC862F8F8B
10:35:30.535 > [ESP32] === END HMAC DEBUG ===
10:35:30.537 > 6_Final_Packet (60): 810218001800040800000002CEAEA634 65740FC51119AD5C791BCE4DCF0714A0 ...
10:35:30.543 > [RETRY] Attempt 1/3 (nonce: 2)
10:35:30.546 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:30.552 > Sending pipeline data to server (560 bytes)
10:35:30.846 > [HTTP] Response code: 400
10:35:30.846 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:30.852 > [HTTP] Request failed with code: 400
10:35:30.854 > [RETRY] Send failed, waiting 100 ms before retry
10:35:30.951 > [RETRY] Attempt 2/3 (nonce: 2)
10:35:30.951 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:30.957 > Sending pipeline data to server (560 bytes)
10:35:31.266 > [HTTP] Response code: 400
10:35:31.266 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:31.271 > [HTTP] Request failed with code: 400
10:35:31.274 > [RETRY] Send failed, waiting 200 ms before retry
10:35:31.470 > [RETRY] Attempt 3/3 (nonce: 2)
10:35:31.470 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:31.475 > Sending pipeline data to server (560 bytes)
10:35:31.759 > [HTTP] Response code: 400
10:35:31.759 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:31.764 > [HTTP] Request failed with code: 400
10:35:31.767 > [RETRY] All retry attempts failed - rolled back nonce to 1
10:35:31.773 > [RETRY] Consecutive failures: 3
10:35:31.776 > Health data send failed (retry count: 3/3)
10:35:31.778 > Health data transmission failed after max retries
10:35:36.889 > [680.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:36.894 > ERROR state - attempting recovery
10:35:36.897 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:36.902 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:35:36.908 > Generated health data: HR-71 SPO2-97 STEPS-3404
10:35:36.911 > [ESP32] MsgKeys: lfsrSeed=0xE268B622 tnk[0..3]=CB8B9637 trn[0..3]=8FC58896
10:35:36.920 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333430344D50
10:35:36.925 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333430344D50000000000000 
10:35:36.934 > [ESP32][LFSR] Initializing - Seed: 0xE268B622 SeedBe: 0x22B668E2 ChaosKey[0..3]: CB8B9637 InitialTap: 0x0029 State: 0xE268B622
10:35:36.945 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:35:36.953 > 3_After_LFSR (32): 6AE445D573002230178B019DBC929881 C999F986C18850DC48D8AE80FBF49AE1 
10:35:36.958 > [ESP32][LFSR] Keystream (first 16 bytes): 22B668E24220716058B92CA48BB2CBD5
10:35:36.967 > [ESP32][TINKERBELL] Input (first 16 bytes): 6AE445D573002230178B019DBC929881 Nonce: 0x00000002 Buffer size: 32 bytes
10:35:36.975 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CB8B9637
10:35:36.986 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:36.994 > 4_After_Tinkerbell (32): 0FC5316A85B57465CE4DA014CF071B79 7D7C5CAD111E3954252634A6CEAEBAA2
10:35:37.003 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 652174BFF6B55655D9C6A189739583F8
10:35:37.011 > 5_After_Transposition (32): CEAEA63465740FC5111EAD5C791BCE4D CF0714A054397D7C85B56A31A2BA2526      
10:35:37.020 > [ESP32] === HMAC DEBUG INFO ===
10:35:37.022 > [ESP32] HMAC Key being used: C3141639CD82C6685A834DF990B00E1F7558E43A679E470918604C8B26D9AD89      
10:35:37.030 > [ESP32] HMAC Input length: 44 bytes
10:35:37.033 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002CEAEA63465740FC5111EAD5C791BCE4DCF0714A0
10:35:37.042 > [ESP32] Nonce: 0x00000002
10:35:37.044 > [ESP32] Packet size before HMAC: 60
10:35:37.047 > [ESP32] Computed HMAC Tag: C7B74AD9947BFC515D504C2FE52B9EA3
10:35:37.053 > [ESP32] === END HMAC DEBUG ===
10:35:37.055 > 6_Final_Packet (60): 810218001800040800000002CEAEA634 65740FC5111EAD5C791BCE4DCF0714A0 ...
10:35:37.064 > [RETRY] Attempt 1/3 (nonce: 2)
10:35:37.067 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:37.072 > Sending pipeline data to server (560 bytes)
10:35:37.283 > [HTTP] Response code: 400
10:35:37.283 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:37.289 > [HTTP] Request failed with code: 400
10:35:37.292 > [RETRY] Send failed, waiting 100 ms before retry
10:35:37.388 > [RETRY] Attempt 2/3 (nonce: 2)
10:35:37.388 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:37.394 > Sending pipeline data to server (560 bytes)
10:35:37.755 > [HTTP] Response code: 400
10:35:37.755 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:37.760 > [HTTP] Request failed with code: 400
10:35:37.763 > [RETRY] Send failed, waiting 200 ms before retry
10:35:37.959 > [RETRY] Attempt 3/3 (nonce: 2)
10:35:37.959 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:37.964 > Sending pipeline data to server (560 bytes)
10:35:38.266 > [HTTP] Response code: 400
10:35:38.267 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:38.272 > [HTTP] Request failed with code: 400
10:35:38.275 > [RETRY] All retry attempts failed - rolled back nonce to 1
10:35:38.280 > [RETRY] Consecutive failures: 4
10:35:38.282 > ✗ Auto-recovery failed - restarting key exchange
10:35:40.382 > [WebSocket] Disconnected!
10:35:40.382 > [684.4] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED  
10:35:40.389 > ✓ Public key loaded from NVS
10:35:40.486 > [684.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:40.587 > [684.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:40.594 > Generating fresh master key from entropy...
10:35:40.601 > Generated master key (32): 1860DC4446A487920984DFAF594D155D F8A0602ACD2B2E3FDB74C57F0111B8AB       
10:35:40.608 > Using reduced master key (byte % 3) for NTRU encryption only
10:35:40.618 > NTRU encrypted master key (502): 007700060007007300690002005F0067 00360006007E00190011001A00090006 ...
10:35:40.627 > POST http://192.168.137.64:8081/master-key
10:35:40.778 > ✓ Master key exchange completed
10:35:40.880 > [684.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:40.888 > Loading master key from NVS and deriving symmetric keys...
10:35:40.891 > Loaded master key from NVS (32): 1860DC4446A487920984DFAF594D155D F8A0602ACD2B2E3FDB74C57F0111B8AB 
10:35:40.902 > Derived HMAC key (32): DD3403571265F0A57DE331902CD7A83C 379B27B0F56FDBE8E0932FD414475FA7 
10:35:40.907 > Derived Tinkerbell key (16): B1DDE598AD56DD0609564BF491051037
10:35:40.913 > Derived Transposition key (16): DEAD66339AA11183EF05E965E3D575D4
10:35:40.921 > ✓ Symmetric keys derived successfully
10:35:40.924 > Nonce tracker reset - new session started
10:35:40.926 > ✓ Symmetric keys ready - starting health data transmission
10:35:41.032 > [685.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.132 > [685.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.233 > [685.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.333 > [685.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.433 > [685.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.532 > [685.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.632 > [685.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.732 > [685.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.833 > [685.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:41.933 > [685.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.033 > [686.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.132 > [686.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.232 > [686.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.333 > [686.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.433 > [686.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.533 > [686.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.633 > [686.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.733 > [686.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.833 > [686.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:42.932 > [686.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.032 > [687.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.132 > [687.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.233 > [687.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.333 > [687.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.433 > [687.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.532 > [687.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.633 > [687.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.733 > [687.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.832 > [687.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:43.932 > [687.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.032 > [688.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.132 > [688.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.233 > [688.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.333 > [688.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.433 > [688.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.532 > [688.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.633 > [688.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.732 > [688.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.833 > [688.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:44.932 > [688.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:45.032 > [689.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:45.132 > [689.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:45.233 > [689.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:45.332 > [689.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.439 > [694.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.539 > [WebSocket] Disconnected!
10:35:50.540 > [694.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED  
10:35:50.641 > [694.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.740 > [694.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.841 > [694.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.940 > [694.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:50.949 > Generated health data: HR-71 SPO2-97 STEPS-3519
10:35:50.952 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:50.957 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:35:50.995 > Generated health data: HR-71 SPO2-97 STEPS-3492
10:35:50.995 > [ESP32] MsgKeys: lfsrSeed=0xFAB7A24D tnk[0..3]=B57D1DA0 trn[0..3]=8C9103F0
10:35:50.995 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333439324D50
10:35:50.995 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333439324D50000000000000
10:35:50.995 > [ESP32][LFSR] Initializing - Seed: 0xFAB7A24D SeedBe: 0x4DA2B7FA ChaosKey[0..3]: B57D1DA0 InitialTap: 0x0029 State: 0xFAB7A24D
10:35:51.002 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
10:35:51.038 > 3_After_LFSR (32): 05F09ACD3F1E25B240C5DD4B13AE5BD9 06B08175CDB83A84794089AE9B7654C9
10:35:51.038 > [ESP32][LFSR] Keystream (first 16 bytes): 4DA2B7FA0E3E76E20FF7F072248E088D
10:35:51.038 > [ESP32][TINKERBELL] Input (first 16 bytes): 05F09ACD3F1E25B240C5DD4B13AE5BD9 Nonce: 0x00000001 Buffer size: 32 bytes
10:35:51.038 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B57D1DA0
10:35:51.040 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:51.050 > 4_After_Tinkerbell (32): 62724008F28B5AFFBEA6DC1167C30294 AA3CF21211A986925453A0E507F77D2C
10:35:51.057 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:51.063 > 5_After_Transposition (32): 084011DCE5A06272F212AA3C92868BF2 11A90294FF5AC36707F7BEA654537D2C      
10:35:51.071 > [ESP32] === HMAC DEBUG INFO ===
10:35:51.074 > [ESP32] HMAC Key being used: DD3403571265F0A57DE331902CD7A83C379B27B0F56FDBE8E0932FD414475FA7
10:35:51.082 > [ESP32] HMAC Input length: 44 bytes
10:35:51.084 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001084011DCE5A06272F212AA3C92868BF211A90294
10:35:51.096 > [ESP32] Nonce: 0x00000001
10:35:51.098 > [ESP32] Packet size before HMAC: 60
10:35:51.101 > [ESP32] Computed HMAC Tag: 06B5EDAB54099802D281C0FB077CB27B
10:35:51.106 > [ESP32] === END HMAC DEBUG ===
10:35:51.109 > 6_Final_Packet (60): 810218001800040800000001084011DC E5A06272F212AA3C92868BF211A90294 ...
10:35:51.115 > [RETRY] Attempt 1/3 (nonce: 1)
10:35:51.117 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:51.123 > Sending pipeline data to server (560 bytes)
10:35:51.271 > [HTTP] Response code: 400
10:35:51.271 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:51.277 > [HTTP] Request failed with code: 400
10:35:51.280 > [RETRY] Send failed, waiting 100 ms before retry
10:35:51.375 > [RETRY] Attempt 2/3 (nonce: 1)
10:35:51.375 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:51.380 > Sending pipeline data to server (560 bytes)
10:35:51.526 > [HTTP] Response code: 400
10:35:51.526 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:51.531 > [HTTP] Request failed with code: 400
10:35:51.534 > [RETRY] Send failed, waiting 200 ms before retry
10:35:51.730 > [RETRY] Attempt 3/3 (nonce: 1)
10:35:51.731 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:51.737 > Sending pipeline data to server (560 bytes)
10:35:52.054 > [HTTP] Response code: 400
10:35:52.055 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:52.060 > [HTTP] Request failed with code: 400
10:35:52.063 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:35:52.068 > [RETRY] Consecutive failures: 5
10:35:52.071 > [EMERGENCY] Triggering emergency reset!
10:35:52.074 > [CRYPTO] Resetting cryptographic state
10:35:52.079 > [CRYPTO] Crypto state reset complete
10:35:52.082 > [CRYPTO] Packet counter: 12
10:35:52.085 > [EMERGENCY] Emergency reset complete
10:35:52.087 > Health data send failed (retry count: 1/3)
10:35:52.183 > [696.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:52.192 > Generated health data: HR-71 SPO2-97 STEPS-3481
10:35:52.194 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:52.199 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:35:52.205 > Generated health data: HR-71 SPO2-97 STEPS-3517
10:35:52.208 > [ESP32] MsgKeys: lfsrSeed=0xFAB7A24D tnk[0..3]=B57D1DA0 trn[0..3]=8C9103F0
10:35:52.214 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333531374D50
10:35:52.222 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333531374D50000000000000
10:35:52.230 > [ESP32][LFSR] Initializing - Seed: 0xFAB7A24D SeedBe: 0x4DA2B7FA ChaosKey[0..3]: B57D1DA0 InitialTap: 0x0029 State: 0xFAB7A24D
10:35:52.241 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
10:35:52.247 > 3_After_LFSR (32): 05F09ACD3F1E25B240C5DD4B13AE5BD9 06B08175CDB93281794089AE9B7654C9
10:35:52.255 > [ESP32][LFSR] Keystream (first 16 bytes): 4DA2B7FA0E3E76E20FF7F072248E088D
10:35:52.263 > [ESP32][TINKERBELL] Input (first 16 bytes): 05F09ACD3F1E25B240C5DD4B13AE5BD9 Nonce: 0x00000001 Buffer size: 32 bytes
10:35:52.272 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B57D1DA0
10:35:52.283 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:52.291 > 4_After_Tinkerbell (32): 62724008F28B5AFFBEA6DC1167C30294 AA3CF21211A88E975453A0E507F77D2C 
10:35:52.299 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:52.305 > 5_After_Transposition (32): 084011DCE5A06272F212AA3C978E8BF2 11A80294FF5AC36707F7BEA654537D2C 
10:35:52.313 > [ESP32] === HMAC DEBUG INFO ===
10:35:52.316 > [ESP32] HMAC Key being used: DD3403571265F0A57DE331902CD7A83C379B27B0F56FDBE8E0932FD414475FA7
10:35:52.324 > [ESP32] HMAC Input length: 44 bytes
10:35:52.327 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001084011DCE5A06272F212AA3C978E8BF211A80294
10:35:52.338 > [ESP32] Nonce: 0x00000001
10:35:52.341 > [ESP32] Packet size before HMAC: 60
10:35:52.343 > [ESP32] Computed HMAC Tag: B8FB7AF580D80A8B7923BFA9DF3187E5
10:35:52.349 > [ESP32] === END HMAC DEBUG ===
10:35:52.352 > 6_Final_Packet (60): 810218001800040800000001084011DC E5A06272F212AA3C978E8BF211A80294 ...
10:35:52.358 > [RETRY] Attempt 1/3 (nonce: 1)
10:35:52.360 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:52.366 > Sending pipeline data to server (560 bytes)
10:35:52.778 > [HTTP] Response code: 400
10:35:52.778 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:52.784 > [HTTP] Request failed with code: 400
10:35:52.787 > [RETRY] Send failed, waiting 100 ms before retry
10:35:52.883 > [RETRY] Attempt 2/3 (nonce: 1)
10:35:52.883 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:52.889 > Sending pipeline data to server (560 bytes)
10:35:53.237 > [HTTP] Response code: 400
10:35:53.237 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:53.242 > [HTTP] Request failed with code: 400
10:35:53.244 > [RETRY] Send failed, waiting 200 ms before retry
10:35:53.440 > [RETRY] Attempt 3/3 (nonce: 1)
10:35:53.440 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:53.445 > Sending pipeline data to server (560 bytes)
10:35:53.778 > [HTTP] Response code: 400
10:35:53.780 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:53.785 > [HTTP] Request failed with code: 400
10:35:53.788 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:35:53.793 > [RETRY] Consecutive failures: 1
10:35:53.796 > Health data send failed (retry count: 2/3)
10:35:53.895 > [697.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:53.904 > Generated health data: HR-71 SPO2-97 STEPS-3527
10:35:53.906 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:53.913 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:35:53.918 > Generated health data: HR-71 SPO2-97 STEPS-3531
10:35:53.920 > [ESP32] MsgKeys: lfsrSeed=0xFAB7A24D tnk[0..3]=B57D1DA0 trn[0..3]=8C9103F0
10:35:53.926 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333533314D50
10:35:53.934 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333533314D50000000000000
10:35:53.943 > [ESP32][LFSR] Initializing - Seed: 0xFAB7A24D SeedBe: 0x4DA2B7FA ChaosKey[0..3]: B57D1DA0 InitialTap: 0x0029 State: 0xFAB7A24D
10:35:53.954 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
10:35:53.960 > 3_After_LFSR (32): 05F09ACD3F1E25B240C5DD4B13AE5BD9 06B08175CDB93087794089AE9B7654C9
10:35:53.968 > [ESP32][LFSR] Keystream (first 16 bytes): 4DA2B7FA0E3E76E20FF7F072248E088D
10:35:53.976 > [ESP32][TINKERBELL] Input (first 16 bytes): 05F09ACD3F1E25B240C5DD4B13AE5BD9 Nonce: 0x00000001 Buffer size: 32 bytes
10:35:53.984 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B57D1DA0
10:35:53.996 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:54.004 > 4_After_Tinkerbell (32): 62724008F28B5AFFBEA6DC1167C30294 AA3CF21211A88C915453A0E507F77D2C
10:35:54.012 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:54.018 > 5_After_Transposition (32): 084011DCE5A06272F212AA3C918C8BF2 11A80294FF5AC36707F7BEA654537D2C 
10:35:54.026 > [ESP32] === HMAC DEBUG INFO ===
10:35:54.029 > [ESP32] HMAC Key being used: DD3403571265F0A57DE331902CD7A83C379B27B0F56FDBE8E0932FD414475FA7
10:35:54.037 > [ESP32] HMAC Input length: 44 bytes
10:35:54.040 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001084011DCE5A06272F212AA3C918C8BF211A80294
10:35:54.051 > [ESP32] Nonce: 0x00000001
10:35:54.054 > [ESP32] Packet size before HMAC: 60
10:35:54.056 > [ESP32] Computed HMAC Tag: 1D581504045B911BC58C7F667C7FC57F
10:35:54.062 > [ESP32] === END HMAC DEBUG ===
10:35:54.065 > 6_Final_Packet (60): 810218001800040800000001084011DC E5A06272F212AA3C918C8BF211A80294 ...
10:35:54.071 > [RETRY] Attempt 1/3 (nonce: 1)
10:35:54.073 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:54.079 > Sending pipeline data to server (560 bytes)
10:35:54.296 > [HTTP] Response code: 400
10:35:54.296 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:54.301 > [HTTP] Request failed with code: 400
10:35:54.304 > [RETRY] Send failed, waiting 100 ms before retry
10:35:54.400 > [RETRY] Attempt 2/3 (nonce: 1)
10:35:54.400 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:54.405 > Sending pipeline data to server (560 bytes)
10:35:54.609 > [HTTP] Response code: 400
10:35:54.609 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:54.615 > [HTTP] Request failed with code: 400
10:35:54.618 > [RETRY] Send failed, waiting 200 ms before retry
10:35:54.812 > [RETRY] Attempt 3/3 (nonce: 1)
10:35:54.813 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:54.818 > Sending pipeline data to server (560 bytes)
10:35:55.035 > [HTTP] Response code: 400
10:35:55.035 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:55.041 > [HTTP] Request failed with code: 400
10:35:55.043 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:35:55.049 > [RETRY] Consecutive failures: 2
10:35:55.051 > Health data send failed (retry count: 3/3)
10:35:55.054 > Health data transmission failed after max retries
10:35:55.160 > [699.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:35:55.166 > ERROR state - attempting recovery
10:35:55.169 > [RETRY] Attempting to send health data (Max retries: 3)
10:35:55.174 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:35:55.179 > Generated health data: HR-71 SPO2-97 STEPS-3541
10:35:55.182 > [ESP32] MsgKeys: lfsrSeed=0xFAB7A24D tnk[0..3]=B57D1DA0 trn[0..3]=8C9103F0
10:35:55.191 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333534314D50
10:35:55.197 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333534314D50000000000000 
10:35:55.205 > [ESP32][LFSR] Initializing - Seed: 0xFAB7A24D SeedBe: 0x4DA2B7FA ChaosKey[0..3]: B57D1DA0 InitialTap: 0x0029 State: 0xFAB7A24D
10:35:55.216 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:35:55.224 > 3_After_LFSR (32): 05F09ACD3F1E25B240C5DD4B13AE5BD9 06B08175CDB93787794089AE9B7654C9
10:35:55.230 > [ESP32][LFSR] Keystream (first 16 bytes): 4DA2B7FA0E3E76E20FF7F072248E088D
10:35:55.239 > [ESP32][TINKERBELL] Input (first 16 bytes): 05F09ACD3F1E25B240C5DD4B13AE5BD9 Nonce: 0x00000001 Buffer size: 32 bytes
10:35:55.246 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B57D1DA0
10:35:55.258 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:55.266 > 4_After_Tinkerbell (32): 62724008F28B5AFFBEA6DC1167C30294 AA3CF21211A88B915453A0E507F77D2C
10:35:55.274 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6782DAC5CD957F4DFE63015A746D594D
10:35:55.283 > 5_After_Transposition (32): 084011DCE5A06272F212AA3C918B8BF2 11A80294FF5AC36707F7BEA654537D2C      
10:35:55.291 > [ESP32] === HMAC DEBUG INFO ===
10:35:55.294 > [ESP32] HMAC Key being used: DD3403571265F0A57DE331902CD7A83C379B27B0F56FDBE8E0932FD414475FA7
10:35:55.302 > [ESP32] HMAC Input length: 44 bytes
10:35:55.305 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001084011DCE5A06272F212AA3C918B8BF211A80294
10:35:55.314 > [ESP32] Nonce: 0x00000001
10:35:55.316 > [ESP32] Packet size before HMAC: 60
10:35:55.319 > [ESP32] Computed HMAC Tag: DDFFE7D46B41FCF92E2CD899D451B33D
10:35:55.325 > [ESP32] === END HMAC DEBUG ===
10:35:55.327 > 6_Final_Packet (60): 810218001800040800000001084011DC E5A06272F212AA3C918B8BF211A80294 ...
10:35:55.336 > [RETRY] Attempt 1/3 (nonce: 1)
10:35:55.339 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:55.344 > Sending pipeline data to server (560 bytes)
10:35:55.535 > [HTTP] Response code: 400
10:35:55.535 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:55.541 > [HTTP] Request failed with code: 400
10:35:55.543 > [RETRY] Send failed, waiting 100 ms before retry
10:35:55.639 > [RETRY] Attempt 2/3 (nonce: 1)
10:35:55.639 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:55.644 > Sending pipeline data to server (560 bytes)
10:35:55.836 > [HTTP] Response code: 400
10:35:55.836 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:55.841 > [HTTP] Request failed with code: 400
10:35:55.844 > [RETRY] Send failed, waiting 200 ms before retry
10:35:56.040 > [RETRY] Attempt 3/3 (nonce: 1)
10:35:56.040 > POST http://192.168.137.64:8081/health-data with pipeline data
10:35:56.046 > Sending pipeline data to server (560 bytes)
10:35:56.298 > [HTTP] Response code: 400
10:35:56.298 > [HTTP] Error response: {"error":"Decryption failed"}
10:35:56.304 > [HTTP] Request failed with code: 400
10:35:56.307 > [RETRY] All retry attempts failed - rolled back nonce to 0
10:35:56.312 > [RETRY] Consecutive failures: 3
10:35:56.315 > ✗ Auto-recovery failed - restarting key exchange
10:36:03.418 > [707.4] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:03.426 > ✓ Public key loaded from NVS
10:36:03.521 > [WebSocket] Disconnected!
10:36:03.522 > [707.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:03.623 > [707.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:03.631 > Generating fresh master key from entropy...
10:36:03.638 > Generated master key (32): 71B7E9DA209078DCF5C4067EC31700FB 2722557B5008DB1C1B03EEF52C90C6FD       
10:36:03.644 > Using reduced master key (byte % 3) for NTRU encryption only
10:36:03.654 > NTRU encrypted master key (502): 0079000600080073006A0000005F0066 00380007007D0018000F001A00090008 ...
10:36:03.663 > POST http://192.168.137.64:8081/master-key
10:36:03.792 > ✓ Master key exchange completed
10:36:03.895 > [707.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:03.903 > Loading master key from NVS and deriving symmetric keys...
10:36:03.906 > Loaded master key from NVS (32): 71B7E9DA209078DCF5C4067EC31700FB 2722557B5008DB1C1B03EEF52C90C6FD 
10:36:03.917 > Derived HMAC key (32): 49C3713F2C728F6C37A6F03DA34EEB56 CEEC117F2B37279D81B417337E0303F1
10:36:03.922 > Derived Tinkerbell key (16): 8C21E250C7D69077832EB192EECC6913 
10:36:03.928 > Derived Transposition key (16): 021C04E4D5412FE67300B996D1AF7A67
10:36:03.937 > ✓ Symmetric keys derived successfully
10:36:03.939 > Nonce tracker reset - new session started
10:36:03.942 > ✓ Symmetric keys ready - starting health data transmission
10:36:04.047 > [708.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.148 > [708.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.248 > [708.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.348 > [708.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.448 > [708.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.548 > [708.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.648 > [708.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.747 > [708.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.847 > [708.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:04.948 > [708.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.048 > [709.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.148 > [709.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.248 > [709.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.348 > [709.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.448 > [709.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.547 > [709.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.647 > [709.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.747 > [709.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.847 > [709.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:05.948 > [709.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.048 > [710.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.148 > [710.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.248 > [710.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.348 > [710.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.448 > [710.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.548 > [710.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.648 > [710.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.747 > [710.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.848 > [710.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:06.948 > [710.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.048 > [711.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.148 > [711.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.247 > [711.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.348 > [711.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.448 > [711.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.548 > [711.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.648 > [711.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.748 > [711.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.848 > [711.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:07.948 > [711.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:08.047 > [712.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:08.148 > [712.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:08.248 > [712.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:08.348 > [712.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:08.447 > [712.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:13.552 > [717.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:13.654 > [WebSocket] Disconnected!
10:36:13.654 > [717.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED  
10:36:13.754 > [717.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:13.854 > [717.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:13.955 > [717.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: DISCONNECTED
10:36:13.963 > Generated health data: HR-71 SPO2-97 STEPS-3625
10:36:13.966 > [RETRY] Attempting to send health data (Max retries: 3)
10:36:13.972 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
10:36:13.977 > Generated health data: HR-71 SPO2-97 STEPS-3618
10:36:13.980 > [ESP32] MsgKeys: lfsrSeed=0x4F2D6781 tnk[0..3]=D69E5E7F trn[0..3]=B75BB99C
10:36:13.985 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333631384D50
10:36:13.993 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333631384D50000000000000
10:36:14.001 > [ESP32][LFSR] Initializing - Seed: 0x4F2D6781 SeedBe: 0x81672D4F ChaosKey[0..3]: D69E5E7F InitialTap: 0x0029 State: 0x4F2D6781
10:36:14.013 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes       
10:36:14.018 > 3_After_LFSR (32): C93500782F0E0070C6E3BB70A32AEF9D DB97891877FA68C36FBD364B3A38AE0C 
10:36:14.027 > [ESP32][LFSR] Keystream (first 16 bytes): 81672D4F1E2E532089D19649940ABCC9
10:36:14.035 > [ESP32][TINKERBELL] Input (first 16 bytes): C93500782F0E0070C6E3BB70A32AEF9D Nonce: 0x00000001 Buffer size: 32 bytes
10:36:14.043 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D69E5E7F
10:36:14.054 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B37BCFD7FEA2EDD7E19EC9913C909084
10:36:14.063 > 4_After_Tinkerbell (32): 7A4ECFAFD1ACEDA7277D72E19FBA7F19 1F15ADBFC9CC3E31141801F695FB655C 
10:36:14.071 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B37BCFD7FEA2EDD7E19EC9913C909084
10:36:14.077 > 5_After_Transposition (32): 1F15ADBFA7ACEDD1277D72E119BA7F9F 7A4ECFAF31CC3EC9141801F65CFB6595 
10:36:14.085 > [ESP32] === HMAC DEBUG INFO ===
10:36:14.088 > [ESP32] HMAC Key being used: 49C3713F2C728F6C37A6F03DA34EEB56CEEC117F2B37279D81B417337E0303F1      
10:36:14.096 > [ESP32] HMAC Input length: 44 bytes
10:36:14.099 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000011F15ADBFA7ACEDD1277D72E119BA7F9F7A4ECFAF
10:36:14.110 > [ESP32] Nonce: 0x00000001
10:36:14.112 > [ESP32] Packet size before HMAC: 60
10:36:14.115 > [ESP32] Computed HMAC Tag: 0633041794B797E5B8F11E285B29F564
10:36:14.121 > [ESP32] === END HMAC DEBUG ===
10:36:14.123 > 6_Final_Packet (60): 8102180018000408000000011F15ADBF A7ACEDD1277D72E119BA7F9F7A4ECFAF ...
10:36:14.129 > [RETRY] Attempt 1/3 (nonce: 1)
10:36:14.132 > POST http://192.168.137.64:8081/health-data with pipeline data
10:36:14.138 > Sending pipeline data to server (560 bytes)
10:36:14.549 > [HTTP] Response code: 200
10:36:14.549 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:36:14.555 > [RETRY] Health data sent successfully!
10:36:14.558 > ✓ Health data #19 sent successfully
10:36:14.655 > [718.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:14.755 > [718.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:14.854 > [718.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:14.955 > [718.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.054 > [719.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.155 > [719.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.254 > [719.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.355 > [719.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.454 > [719.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.554 > [719.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.655 > [719.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.755 > [719.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.855 > [719.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:15.955 > [719.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.055 > [720.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.154 > [720.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.254 > [720.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.355 > [720.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.455 > [720.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.555 > [720.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.655 > [720.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.755 > [720.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.854 > [720.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:16.954 > [720.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.054 > [721.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.155 > [721.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.255 > [721.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.355 > [721.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.455 > [721.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.556 > [721.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.655 > [721.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.755 > [721.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.856 > [721.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:17.956 > [721.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.056 > [722.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.155 > [722.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.256 > [722.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.355 > [722.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.456 > [722.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:18.556 > [722.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:23.661 > [727.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:23.763 > [WebSocket] Disconnected!
10:36:23.763 > [727.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED  
10:36:23.863 > [727.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:23.964 > [728.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.063 > [728.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.164 > [728.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.263 > [728.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.364 > [728.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.463 > [728.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.564 > [728.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: DISCONNECTED
10:36:24.572 > Generated health data: HR-72 SPO2-97 STEPS-3672
10:36:24.575 > [RETRY] Attempting to send health data (Max retries: 3)
10:36:24.580 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
10:36:24.585 > Generated health data: HR-73 SPO2-97 STEPS-3652
10:36:24.588 > [ESP32] MsgKeys: lfsrSeed=0xE2CDB98D tnk[0..3]=30AF6FB1 trn[0..3]=2F3F2135
10:36:24.594 > 1_After_Salt (26): 48522D37332053504F322D3937205354 4550532D333635324D50
10:36:24.602 > 2_After_Padding (32): 48522D37332053504F322D3937205354 4550532D333635324D50000000000000
10:36:24.610 > [ESP32][LFSR] Initializing - Seed: 0xE2CDB98D SeedBe: 0x8DB9CDE2 ChaosKey[0..3]: 30AF6FB1 InitialTap: 0x0029 State: 0xE2CDB98D
10:36:24.622 > [ESP32][LFSR] Input (first 16 bytes): 48522D37332053504F322D3937205354 Buffer size: 32 bytes       
10:36:24.627 > 3_After_LFSR (32): C5EBE0D5B99269B381E1F7F4D6E0195A 876CEF36A2B980CD30F45946E403C893 
10:36:24.636 > [ESP32][LFSR] Keystream (first 16 bytes): 8DB9CDE28AB23AE3CED3DACDE1C04A0E
10:36:24.644 > [ESP32][TINKERBELL] Input (first 16 bytes): C5EBE0D5B99269B381E1F7F4D6E0195A Nonce: 0x00000002 Buffer size: 32 bytes
10:36:24.652 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 30AF6FB1
10:36:24.663 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B540A85AD9930609EC47CF09537977DE
10:36:24.671 > 4_After_Tinkerbell (32): 70AB488F60016FBA6DA638FD85996E84 24501749B51AF67E0FA50C64DAAC0CD3 
10:36:24.680 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B540A85AD9930609EC47CF09537977DE
10:36:24.685 > 5_After_Transposition (32): 60016FBA70AB488F85996E846DA638FD B51AF67E24501749DAAC0CD30FA50C64 
10:36:24.693 > [ESP32] === HMAC DEBUG INFO ===
10:36:24.696 > [ESP32] HMAC Key being used: 49C3713F2C728F6C37A6F03DA34EEB56CEEC117F2B37279D81B417337E0303F1      
10:36:24.704 > [ESP32] HMAC Input length: 44 bytes
10:36:24.707 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000260016FBA70AB488F85996E846DA638FDB51AF67E
10:36:24.718 > [ESP32] Nonce: 0x00000002
10:36:24.721 > [ESP32] Packet size before HMAC: 60
10:36:24.724 > [ESP32] Computed HMAC Tag: 0EDB29B0FB7AD7AFF9E09A224C6FADC7
10:36:24.729 > [ESP32] === END HMAC DEBUG ===
10:36:24.733 > 6_Final_Packet (60): 81021800180004080000000260016FBA 70AB488F85996E846DA638FDB51AF67E ...
10:36:24.738 > [RETRY] Attempt 1/3 (nonce: 2)
10:36:24.741 > POST http://192.168.137.64:8081/health-data with pipeline data
10:36:24.747 > Sending pipeline data to server (560 bytes)
10:36:25.050 > [HTTP] Response code: 200
10:36:25.050 > [HTTP] Response: {"status":"OK:DECRYPTED"}
10:36:25.056 > [RETRY] Health data sent successfully!
10:36:25.059 > ✓ Health data #20 sent successfully
10:36:25.156 > [729.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 20 | WS: DISCONNECTED
10:36:25.164 > Reached MAX_PACKETS limit; pausing transmissions
